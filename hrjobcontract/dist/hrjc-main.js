//! moment.js
//! version : 2.8.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/*
fraction.js
A Javascript fraction library.

Copyright (c) 2009  Erik Garrison <erik@hypervolu.me>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/

(function(){define("controllers/controllers",["angular"],function(e){"use strict";return e.module("hrjc.controllers",[])}),define("directives/directives",["angular"],function(e){"use strict";return e.module("hrjc.directives",[])}),define("filters/filters",["angular"],function(e){"use strict";return e.module("hrjc.filters",[])}),define("services/services",["angular"],function(e){"use strict";return e.module("hrjc.services",[])}),define("app",["angular","angularAnimate","angularBootstrap","angularFileUpload","angularResource","angularRoute","controllers/controllers","directives/directives","filters/filters","services/services"],function(e){return e.module("hrjc",["ngAnimate","ngRoute","ngResource","ui.bootstrap","angularFileUpload","hrjc.controllers","hrjc.directives","hrjc.filters","hrjc.services"])}),define("services/contract",["services/services"],function(e){e.factory("Contract",["$resource","settings","$log",function(e,t,n){return n.debug("Service: Contract"),e(t.pathRest,{action:"get",entity:"HRJobContract",json:{}})}]),e.factory("ContractRevision",["$resource","settings","$log",function(e,t,n){return n.debug("Service: ContractRevision"),e(t.pathRest,{action:"get",entity:"HRJobContractRevision",json:{}})}]),e.factory("ContractService",["Contract","ContractRevision","settings","$q","UtilsService","$log",function(e,t,n,r,i,s){return s.debug("Service: ContractRevision"),{get:function(t){var s=r.defer(),o={};return!CRM||!CRM.jobContractTabApp||!CRM.jobContractTabApp.contractList?(o={sequential:1,contact_id:n.contactId,deleted:0},t&&typeof +t=="number"&&(o.contact_id=t),e.get({json:o},function(e){if(i.errorHandler(e,"Unable to fetch contract list",s))return;s.resolve(e.values)},function(){s.reject("Unable to fetch contract list")})):s.resolve(CRM.jobContractTabApp.contractList),s.promise},getOne:function(t,i){if(!t||typeof +t!="number")return null;var s=r.defer(),o={deleted:0,sequential:1,contact_id:n.contactId,id:t},u;return i&&typeof +i=="number"&&(o.contact_id=i),e.get({json:o},function(e){u=e.values,s.resolve(u.length==1?u[0]:null)},function(){s.reject("Unable to fetch contract data")}),s.promise},getRevision:function(e){if(!e||typeof +e!="number")return null;var n=r.defer(),i={deleted:0,options:{limit:0},sequential:1,jobcontract_id:e};return t.get({json:i},function(e){n.resolve(e.values)},function(){n.reject("Unable to fetch contract revisions")}),n.promise},getRevisionOptions:function(e,t){var i=r.defer(),s;if(!t){var s=n.CRM.options.HRJobContractRevision||{};e&&typeof e=="string"&&(s=s[optionGroup]),i.resolve(s||{})}return i.promise},save:function(t){if(!t||typeof t!="object"||!t.id||typeof +t.id!="number")return null;var n=r.defer(),i=angular.extend({deleted:0,sequential:1},t),s;return e.save({action:"create",json:i},null,function(e){s=e.values,n.resolve(s.length==1?s[0]:null)},function(){n.reject("Unable to fetch contract contract data")}),n.promise},saveRevision:function(e){if(!e||typeof e!="object"||!e.id||typeof +e.id!="number")return null;var n=r.defer(),i=angular.extend({deleted:0,sequential:1},e),s;return t.save({action:"create",json:i},null,function(e){s=e.values,n.resolve(s.length==1?s[0]:null)},function(){n.reject("Unable to fetch contract revision")}),n.promise},"delete":function(t){if(!t||typeof +t!="number")return null;var n=r.defer();return e.delete({action:"deletecontract",json:{id:t}},function(e){n.resolve(e)},function(){n.reject("Could not delete contract ID:"+t)}),n.promise},deleteRevision:function(e){if(!e||typeof +e!="number")return null;var n=r.defer(),i;return t.save({action:"create",json:{sequential:1,deleted:1,id:e}},null,function(e){i=e.values,n.resolve(i.length==1?i[0]:null)},function(){n.reject("Unable to delete contract revision id: "+e)}),n.promise}}}])}),define("filters/getObjById",["filters/filters"],function(e){e.filter("getObjById",["$log",function(e){return e.debug("Filter: getObjById"),function(e,t,n){var r=0,i=e.length;for(;r<i;r++)if(+e[r].id==+t)return n?e[r][n]:e[r];return null}}])}),define("services/utils",["services/services"],function(e){e.factory("API",["$resource","$q","settings","$log",function(e,t,n,r){return r.debug("Service: UtilsService"),{resource:function(t,r,i){return!t||typeof t!="string"||!r||typeof r!="string"||i&&typeof i!="object"?null:e(n.pathRest,{action:r,entity:t,json:i})},getOne:function(e,n){if(!e||typeof e!="string"||n&&typeof n!="object")return null;var r=t.defer(),i=angular.extend({sequential:1},n),s;return this.resource(e,"get",i).get(function(e){s=e.values,r.resolve(s.length==1?s[0]:null)},function(){r.reject("Unable to fetch data")}),r.promise},get:function(e,n){if(!e||typeof e!="string"||n&&typeof n!="object")return null;var r=t.defer(),i=angular.extend({sequential:1},n);return this.resource(e,"get",i).get(function(e){r.resolve(e.values)},function(){r.reject("Unable to fetch data")}),r.promise}}}]),e.factory("testAPI",["$resource","settings",function(e,t){return{resource:function(n,r,i){return!n||typeof n!="string"||!r||typeof r!="string"||i&&typeof i!="object"?null:e(t.pathApp+"js/data/"+n+".json",{action:r,entity:n,json:i})}}}]),e.factory("UtilsService",["API","testAPI","settings","$q","$log","$timeout",function(e,t,n,r,i,s){return{getAbsenceType:function(){var t=r.defer();return e.resource("HRAbsenceType","get",{"return":"id,name,title"}).get(function(e){t.resolve(e.values)},function(){t.reject("Unable to fetch absence types")}),t.promise},getHoursLocation:function(){var t=r.defer();return e.resource("HRHoursLocation","get",{sequential:1}).get(function(e){t.resolve(e.values)},function(){t.reject("Unable to fetch standard hours")}),t.promise},getPayScaleGrade:function(){var t=r.defer();return e.resource("HRPayScale","get",{sequential:1}).get(function(e){t.resolve(e.values)},function(){t.reject("Unable to fetch standard hours")}),t.promise},prepareEntityIds:function(e,t,n){function r(e){e.jobcontract_id=t,delete e.id,n?e.jobcontract_revision_id=n:delete e.jobcontract_revision_id}if(angular.isArray(e)){var i=0,s=e.length;for(i;i<s;i++)r(e[i]);return}if(angular.isObject(e)){r(e);return}},errorHandler:function(e,t,n){if(e.is_error)return i.error(e.error_code+"\n"+e.error_message),n&&n.reject(e.error_code+"\n"+e.error_message),e.trace&&i.error(e.trace),!0;if(!e.values)return i.error(t||"Unknown Error"),n&&n.reject(t||"Unknown Error"),!0}}}])}),define("services/contractDetails",["services/services","services/utils"],function(e){e.factory("ContractDetailsService",["$resource","settings","$q","UtilsService","$log",function(e,t,n,r,i){i.debug("Service: ContractDetailsService");var s=e(t.pathRest,{action:"get",entity:"HRJobDetails",json:{}});return{getOne:function(e){if(!e||typeof e!="object"||!e.jobcontract_id&&!e.jobcontract_revision_id||e.jobcontract_id&&typeof +e.jobcontract_id!="number"||e.jobcontract_revision_id&&typeof +e.jobcontract_revision_id!="number")return null;e.sequential=1,e.debug=t.debug;var i=n.defer(),o;return s.get({json:e},function(e){if(r.errorHandler(e,"Unable to fetch contract details",i))return;o=e.values,i.resolve(o.length==1?o[0]:null)},function(){i.reject("Unable to fetch contract details")}),i.promise},getOptions:function(e,r){var i=n.defer(),s;return r||(s=t.CRM.options.HRJobDetails||{},e&&typeof e=="string"&&(s=s[e]),i.resolve(s||{})),i.promise},getFields:function(e){if(e&&typeof e!="object")return null;if(!e||typeof e!="object")e={};var r=n.defer(),i=t.CRM.fields;return i&&i.HRJobDetails?r.resolve(i.HRJobDetails):(e.sequential=1,s.get({action:"getfields",json:e},function(e){e.values||r.reject("Unable to fetch contract details fields"),r.resolve(e.values)},function(){r.reject("Unable to fetch contract details fields")})),r.promise},save:function(e){if(!e||typeof e!="object")return null;var i=n.defer(),o=angular.extend({sequential:1,debug:t.debug},e),u;return s.save({action:"create",json:o},null,function(e){if(r.errorHandler(e,"Unable to create contract details",i))return;u=e.values,i.resolve(u.length==1?u[0]:null)},function(){i.reject("Unable to create contract details")}),i.promise},model:function(e){function r(e){var t=0,n=e.length,r={};for(t;t<n;t++)r[e[t].name]="";return typeof r.id!="undefined"&&(r.id=null),typeof r.jobcontract_revision_id!="undefined"&&(r.jobcontract_revision_id=null),typeof r.location!="undefined"&&(r.location=null),r}var t=n.defer();return e?t.resolve(r(e)):this.getFields().then(function(e){t.resolve(r(e))}),t.promise}}}])}),define("services/contractHour",["services/services","services/utils"],function(e){e.factory("ContractHourService",["$resource","settings","$q","UtilsService","$log",function(e,t,n,r,i){i.debug("Service: ContractHourService");var s=e(t.pathRest,{action:"get",entity:"HRJobHour",json:{}});return{getOne:function(e){if(!e||typeof e!="object"||!e.jobcontract_id&&!e.jobcontract_revision_id||e.jobcontract_id&&typeof +e.jobcontract_id!="number"||e.jobcontract_revision_id&&typeof +e.jobcontract_revision_id!="number")return null;e.sequential=1,e.debug=t.debug;var i=n.defer(),o;return s.get({json:e},function(e){if(r.errorHandler(e,"Unable to fetch contract hours",i))return;o=e.values,i.resolve(o.length==1?o[0]:null)},function(){i.reject("Unable to fetch contract hours")}),i.promise},getOptions:function(e,r){var i=n.defer(),s;if(!r){var s=t.CRM.options.HRJobHour||{};e&&typeof e=="string"&&(s=s[e]),i.resolve(s||{})}return i.promise},getFields:function(e){if(e&&typeof e!="object")return null;if(!e||typeof e!="object")e={};var r=n.defer(),i=t.CRM.fields;return i&&i.HRJobHour?r.resolve(i.HRJobHour):(e.sequential=1,s.get({action:"getfields",json:e},function(e){e.values||r.reject("Unable to fetch contract hours fields"),r.resolve(e.values)},function(){r.reject("Unable to fetch contract hours fields")})),r.promise},save:function(e){if(!e||typeof e!="object")return null;var i=n.defer(),o=angular.extend({sequential:1,debug:t.debug},e),u;return s.save({action:"create",json:o},null,function(e){if(r.errorHandler(e,"Unable to create contract hours",i))return;u=e.values,i.resolve(u.length==1?u[0]:null)},function(){i.reject("Unable to create contract hours")}),i.promise},model:function(e){function r(e){var t=0,n=e.length,r={};for(t;t<n;t++)r[e[t].name]="";return typeof r.id!="undefined"&&(r.id=null),typeof r.jobcontract_revision_id!="undefined"&&(r.jobcontract_revision_id=null),r}var t=n.defer();return e?t.resolve(r(e)):this.getFields().then(function(e){t.resolve(r(e))}),t.promise}}}])}),define("services/contractHealth",["services/services","services/utils"],function(e){e.factory("ContractHealthService",["$resource","settings","$q","UtilsService","$log",function(e,t,n,r,i){i.debug("Service: ContractHealthService");var s=e(t.pathRest,{action:"get",entity:"HRJobHealth",json:{}});return{getOne:function(e){if(!e||typeof e!="object"||!e.jobcontract_id&&!e.jobcontract_revision_id||e.jobcontract_id&&typeof +e.jobcontract_id!="number"||e.jobcontract_revision_id&&typeof +e.jobcontract_revision_id!="number")return null;e.sequential=1,e.debug=t.debug;var i=n.defer(),o;return s.get({json:e},function(e){if(r.errorHandler(e,"Unable to fetch contract Health",i))return;o=e.values,i.resolve(o.length==1?o[0]:null)},function(){i.reject("Unable to fetch contract Health")}),i.promise},getOptions:function(e,r){var i=n.defer(),s;if(!r){var s=t.CRM.options.HRJobHealth||{};e&&typeof e=="string"&&(s=s[e]),i.resolve(s||{})}return i.promise},getFields:function(e){if(e&&typeof e!="object")return null;if(!e||typeof e!="object")e={};var r=n.defer(),i=t.CRM.fields;return i&&i.HRJobHealth?r.resolve(i.HRJobHealth):(e.sequential=1,s.get({action:"getfields",json:e},function(e){e.values||r.reject("Unable to fetch contract insurance fields"),r.resolve(e.values)},function(){r.reject("Unable to fetch contract insurance fields")})),r.promise},save:function(e){if(!e||typeof e!="object")return null;var i=n.defer(),o=angular.extend({sequential:1,debug:t.debug},e),u;return s.save({action:"create",json:o},null,function(e){if(r.errorHandler(e,"Unable to create contract insurance",i))return;u=e.values,i.resolve(u.length==1?u[0]:null)},function(){i.reject("Unable to create contract insurance")}),i.promise},model:function(e){function r(e){var t=0,n=e.length,r={};for(t;t<n;t++)r[e[t].name]="";return typeof r.id!="undefined"&&(r.id=null),typeof r.jobcontract_revision_id!="undefined"&&(r.jobcontract_revision_id=null),r}var t=n.defer();return e?t.resolve(r(e)):this.getFields().then(function(e){t.resolve(r(e))}),t.promise}}}])}),define("services/contractLeave",["services/services","services/utils"],function(e){e.factory("ContractLeaveService",["$resource","$q","settings","UtilsService","$log",function(e,t,n,r,i){i.debug("Service: ContractLeaveService");var s=e(n.pathRest,{action:"get",entity:"HRJobLeave",json:{}});return{get:function(e){if(!e||typeof e!="object"||!e.jobcontract_id&&!e.jobcontract_revision_id||e.jobcontract_id&&typeof +e.jobcontract_id!="number"||e.jobcontract_revision_id&&typeof +e.jobcontract_revision_id!="number"||e.id&&typeof +e.id!="number"||e.leaveType&&typeof +e.leaveType!="number")return null;e.sequential=1,e.debug=n.debug;var i=t.defer();return s.get({json:e},function(e){if(r.errorHandler(e,"Unable to fetch contract leave",i))return;i.resolve(e.values)},function(){i.reject("Unable to fetch contract leave")}),i.promise},getOptions:function(e,r){var i=t.defer(),s;if(!r){var s=n.CRM.options.HRJobLeave||{};e&&typeof e=="string"&&(s=s[e]),i.resolve(s||{})}return i.promise},getFields:function(e){if(e&&typeof e!="object")return null;if(!e||typeof e!="object")e={};var r=t.defer(),i=n.CRM.fields;return i&&i.HRJobLeave?r.resolve(i.HRJobLeave):(e.sequential=1,s.get({action:"getfields",json:e},function(e){e.values||r.reject("Unable to fetch contract leave fields"),r.resolve(e.values)},function(){r.reject("Unable to fetch contract leave fields")})),r.promise},save:function(e){if(!e||typeof e!="object")return null;var i=t.defer(),o={sequential:1,values:e,debug:n.debug};return s.save({action:"replace",json:o},null,function(e){if(r.errorHandler(e,"Unable to create contract leave",i))return;i.resolve(e.values)},function(){i.reject("Unable to create contract details")}),i.promise},model:function(e,n){function s(e,t){var n=0,r=t.length,i=[],s={};for(n;n<r;n++)s[t[n].name]="";return typeof s.id!="undefined"&&(s.id=null),typeof s.jobcontract_revision_id!="undefined"&&(s.jobcontract_revision_id=null),typeof s.location!="undefined"&&(s.location=null),!e||typeof e!="object"||!s||typeof s!="object"||typeof s.leave_type=="undefined"?null:(angular.forEach(e,function(e,t){s.leave_type=t,s.leave_amount=0,i.push(angular.copy(s))}),i)}var r=t.defer(),i=!n||typeof n!="object"?this.getOptions("leave_type"):n;return e?t.when(i).then(function(t){r.resolve(s(t,e))}):this.getFields().then(function(e){t.when(i).then(function(t){r.resolve(s(t,e))})}.bind(this)),r.promise}}}])}),define("services/contractPay",["services/services","services/utils"],function(e){e.factory("ContractPayService",["$resource","settings","$q","UtilsService","$log",function(e,t,n,r,i){i.debug("Service: ContractPayService");var s=e(t.pathRest,{action:"get",entity:"HRJobPay",json:{}});return{getOne:function(e){if(!e||typeof e!="object"||!e.jobcontract_id&&!e.jobcontract_revision_id||e.jobcontract_id&&typeof +e.jobcontract_id!="number"||e.jobcontract_revision_id&&typeof +e.jobcontract_revision_id!="number")return null;e.sequential=1,e.debug=t.debug;var i=n.defer(),o;return s.get({json:e},function(e){if(r.errorHandler(e,"Unable to fetch contract pay",i))return;o=e.values,i.resolve(o.length==1?o[0]:null)},function(){i.reject("Unable to fetch contract pay")}),i.promise},getOptions:function(e,r){var i=n.defer(),s;if(!r){var s=t.CRM.options.HRJobPay||{};e&&typeof e=="string"&&(s=s[optionGroup]),i.resolve(s||{})}return i.promise},getFields:function(e){if(e&&typeof e!="object")return null;if(!e||typeof e!="object")e={};var r=n.defer(),i=t.CRM.fields;return i&&i.HRJobPay?r.resolve(i.HRJobPay):(e.sequential=1,s.get({action:"getfields",json:e},function(e){e.values||r.reject("Unable to fetch contract pay fields"),r.resolve(e.values)},function(){r.reject("Unable to fetch contract pay fields")})),r.promise},save:function(e){if(!e||typeof e!="object")return null;var i=n.defer(),o=angular.extend({sequential:1,debug:t.debug},e),u;return s.save({action:"create",json:o},null,function(e){if(r.errorHandler(e,"Unable to create contract pay",i))return;u=e.values,i.resolve(u.length==1?u[0]:null)},function(){i.reject("Unable to create contract pay")}),i.promise},model:function(e){function r(e){var t=0,n=e.length,r={};for(t;t<n;t++)r[e[t].name]="";return typeof r.id!="undefined"&&(r.id=null),typeof r.jobcontract_revision_id!="undefined"&&(r.jobcontract_revision_id=null),typeof r.annual_benefits!="undefined"&&(r.annual_benefits=[]),typeof r.annual_deductions!="undefined"&&(r.annual_deductions=[]),r}var t=n.defer();return e?t.resolve(r(e)):this.getFields().then(function(e){t.resolve(r(e))}),t.promise}}}])}),define("services/contractPension",["services/services","services/utils"],function(e){e.factory("ContractPensionService",["$resource","settings","$q","UtilsService","$log",function(e,t,n,r,i){i.debug("Service: ContractPensionService");var s=e(t.pathRest,{action:"get",entity:"HRJobPension",json:{}});return{getOne:function(e){if(!e||typeof e!="object"||!e.jobcontract_id&&!e.jobcontract_revision_id||e.jobcontract_id&&typeof +e.jobcontract_id!="number"||e.jobcontract_revision_id&&typeof +e.jobcontract_revision_id!="number")return null;e.sequential=1,e.debug=t.debug;var i=n.defer(),o;return s.get({json:e},function(e){if(r.errorHandler(e,"Unable to fetch contract pension",i))return;o=e.values,i.resolve(o.length==1?o[0]:null)},function(){i.reject("Unable to fetch contract pension")}),i.promise},getOptions:function(e,r){var i=n.defer(),s;if(!r){var s=t.CRM.options.HRJobPension||{};e&&typeof e=="string"&&(s=s[optionGroup]),i.resolve(s||{})}return i.promise},getFields:function(e){if(e&&typeof e!="object")return null;if(!e||typeof e!="object")e={};var r=n.defer(),i=t.CRM.fields;return i&&i.HRJobPension?r.resolve(i.HRJobPension):(e.sequential=1,s.get({action:"getfields",json:e},function(e){e.values||r.reject("Unable to fetch contract pension fields"),r.resolve(e.values)},function(){r.reject("Unable to fetch contract pension fields")})),r.promise},save:function(e){if(!e||typeof e!="object")return null;var i=n.defer(),o=angular.extend({sequential:1,debug:t.debug},e),u;return s.save({action:"create",json:o},null,function(e){if(r.errorHandler(e,"Unable to create contract pension",i))return;u=e.values,i.resolve(u.length==1?u[0]:null)},function(){i.reject("Unable to create contract pension")}),i.promise},model:function(e){function r(e){var t=0,n=e.length,r={};for(t;t<n;t++)r[e[t].name]="";return typeof r.id!="undefined"&&(r.id=null),typeof r.jobcontract_revision_id!="undefined"&&(r.jobcontract_revision_id=null),r}var t=n.defer();return e?t.resolve(r(e)):this.getFields().then(function(e){t.resolve(r(e))}),t.promise}}}])}),define("controllers/contractList",["controllers/controllers","filters/getObjById","services/contractDetails","services/contractHour","services/contractHealth","services/contractLeave","services/contractPay","services/contractPension","services/utils"],function(e){e.controller("ContractListCtrl",["$scope","$rootElement","$rootScope","$modal","$q","$filter","contractList","ContractService","ContractDetailsService","ContractHourService","ContractPayService","ContractLeaveService","ContractHealthService","ContractPensionService","UtilsService","settings","$log",function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){m.debug("Controller: ContractListCtrl");var g={details:a,hour:f,pay:l,leave:c,health:h,pension:p},y,b={},w={},E={};e.contractListLoaded=!1,e.contractCurrent=[],e.contractPast=[];for(y in g)b[y]=g[y].getFields();i.all(b).then(function(t){e.fields=t,m.debug("FIELDS:"),m.debug(t);for(y in g)w[y]=g[y].model(t[y]);return i.all(w)}).then(function(t){e.model=t,m.debug("MODEL:"),m.debug(t),o=s("orderBy")(o,"-is_primary"),angular.forEach(o,function(t){+t.is_current?e.contractCurrent.push(t):e.contractPast.push(t)}),e.$watchCollection("contractCurrent",function(){e.utils.contractListLen=e.contractCurrent.length+e.contractPast.length}),e.$watchCollection("contractPast",function(){e.utils.contractListLen=e.contractCurrent.length+e.contractPast.length}),n.$broadcast("hrjc-loader-hide"),e.contractListLoaded=!0}),e.utils=i.all({contractListLen:o.length,hoursLocation:d.getHoursLocation(),payScaleGrade:d.getPayScaleGrade()}),e.toggleIsPrimary=function(t){function n(e){var n=0,r=e.length;for(n;n<r;n++)if(+e[n].id!=+t&&+e[n].is_primary)return e[n].is_primary="0",e[n].id;return null}n(e.contractCurrent)||n(e.contractPast),(s("getObjById")(e.contractCurrent,t)||s("getObjById")(e.contractPast,t)||{}).is_primary="1",e.contractCurrent=s("orderBy")(e.contractCurrent,"-is_primary"),e.contractPast=s("orderBy")(e.contractPast,"-is_primary")},e.modalContract=function(n){if(!n||n!=="new")return null;var i,s={targetDomEl:t.find("div").eq(0),templateUrl:v.pathApp+"views/modalForm.html?v=fbwefg",size:"lg",controller:"ModalContractNewCtrl",resolve:{model:function(){return e.model},utils:function(){return e.utils}}};i=r.open(s),i.result.then(function(t){+t.is_current?e.contractCurrent.push(t):e.contractPast.push(t),+t.is_primary&&e.toggleIsPrimary(t.id)})},e.delete=function(n){var i=r.open({targetDomEl:t.find("div").eq(0),templateUrl:v.pathApp+"views/modalDialog.html",size:"sm",controller:"ModalDialogCtrl",resolve:{content:function(){return{msg:"Are you sure you want to delete this job contract?"}}}});i.result.then(function(t){t&&(e.$emit("hrjc-loader-show"),u.delete(n).then(function(t){if(!t.is_error){function r(t,n){var r=0,i=t.length;for(r;r<i;r++)if(+t[r].id==n)return e.$emit("hrjc-loader-hide"),t.splice(r,1),n;return null}r(e.contractCurrent,n)||r(e.contractPast,n)}}))})}}])}),define("services/contact",["services/services","services/utils"],function(e){e.factory("ContactService",["$resource","settings","$q","UtilsService","$log",function(e,t,n,r,i){i.debug("Service: ContactService");var s=e(t.pathRest,{action:"getlist",entity:"contact",json:{}});return{getOne:function(e){if(!e||typeof +e!="number")return null;var i=n.defer(),o;return s.get({json:{id:e,debug:t.debug}},function(e){if(r.errorHandler(e,"Unable to fetch contact",i))return;o=e.values,i.resolve(o.length==1?o[0]:null)},function(){i.reject("Unable to fetch contact")}),i.promise},search:function(e,i){if(!e||typeof e=="undefined"||i&&typeof i!="object")return null;var o=n.defer(),i=i||{};return s.get({json:{input:e,params:i,debug:t.debug}},function(e){if(r.errorHandler(e,"Unable to fetch contact list",o))return;o.resolve(e.values)},function(){o.reject("Unable to fetch contact list")}),o.promise}}}])}),define("controllers/contract",["controllers/controllers","services/contractDetails","services/contractHour","services/contractPay","services/contractLeave","services/contractPension","services/contractHealth","services/contact","services/utils"],function(e){e.controller("ContractCtrl",["$scope","$route","$filter","$modal","$rootElement","$q","settings","API","ContractDetailsService","ContractHourService","ContractPayService","ContractLeaveService","ContractHealthService","ContractPensionService","ContractFilesService","ContactService","$log",function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){function b(t){var n={id:null,jobcontract_id:g,jobcontract_revision_id:t.details.jobcontract_revision_id};angular.extend(e.details,t.details),angular.extend(e.hour,t.hour||n),angular.extend(e.pay,t.pay||n),t.health&&t.health.provider&&t.health.provider!=e.health.provider&&v.getOne(t.health.provider).then(function(t){e.health.provider_contact=t}),t.health&&t.health.provider_life_insurance&&t.health.provider_life_insurance!=e.health.provider_life_insurance&&v.getOne(t.health.provider_life_insurance).then(function(t){e.health.provider_life_insurance_contact=t}),angular.extend(e.health,t.health||n),angular.extend(e.pension,t.pension||n),angular.forEach(e.leave,function(e,r){angular.extend(e,t.leave?t.leave[r]||n:n)})}m.debug("Controller: ContractCtrl");var g=e.contract.id,y;e.contractLoaded=!1,e.isCollapsed=!0,e.revisionCurrent={},e.revisionList=[],e.revisionDataList=[],angular.extend(e,angular.copy(e.model)),s.all({details:a.getOne({jobcontract_id:g}),hour:f.getOne({jobcontract_id:g}),pay:l.getOne({jobcontract_id:g}),leave:c.get({jobcontract_id:g}),health:h.getOne({jobcontract_id:g}),pension:p.getOne({jobcontract_id:g})}).then(function(t){b(t),e.contractLoaded=!0,e.$watch("contract.is_primary",function(){e.isCollapsed=!+e.contract.is_primary}),e.$broadcast("hrjc-loader-hide")}).then(function(){y=s.all({details:d.get(e.details.jobcontract_revision_id,"civicrm_hrjobcontract_details"),pension:d.get(e.pension.jobcontract_revision_id,"civicrm_hrjobcontract_pension")})}),e.modalContract=function(t,n){e.$broadcast("hrjc-loader-show");var u,v={controller:"ModalContractCtrl",targetDomEl:i.find("div").eq(0),templateUrl:o.pathApp+"views/modalForm.html?v=65463",size:"lg",resolve:{action:function(){return t||"view"},content:function(){return null},entity:function(){return n?s.all({details:a.getOne({jobcontract_revision_id:n.details_revision_id}),hour:f.getOne({jobcontract_revision_id:n.hour_revision_id}),pay:l.getOne({jobcontract_revision_id:n.pay_revision_id}),leave:c.get({jobcontract_revision_id:n.leave_revision_id}),health:h.getOne({jobcontract_revision_id:n.health_revision_id}),pension:p.getOne({jobcontract_revision_id:n.pension_revision_id})}).then(function(t){var n={contract:e.contract},r={id:null,jobcontract_id:g,jobcontract_revision_id:t.details.jobcontract_revision_id};return angular.extend(n,angular.copy(e.model)),angular.extend(n.details,t.details),angular.extend(n.hour,t.hour||r),angular.extend(n.pay,t.pay||r),angular.forEach(n.leave,function(e,n){angular.extend(e,t.leave?t.leave[n]||r:r)}),angular.extend(n.health,t.health||r),angular.extend(n.pension,t.pension||r),n}):{contract:e.contract,details:e.details,hour:e.hour,pay:e.pay,leave:e.leave,health:e.health,pension:e.pension}},files:function(){return n?s.all({details:d.get(n.details_revision_id,"civicrm_hrjobcontract_details"),pension:d.get(n.pension_revision_id,"civicrm_hrjobcontract_pension")}):y},utils:function(){return e.utils}}};switch(t){case"edit":v.resolve.content=function(){return{allowSave:!0,isDisabled:!1,copy:{close:"Cancel",save:"Save without making a new revision",title:"Edit contract"}}};break;case"change":v.resolve.content=function(){return{allowSave:!0,isDisabled:!1,copy:{close:"Cancel",save:"Save and make a new revision",title:"Change contract terms"}}}}u=r.open(v),u.result.then(function(t){if(!t)return;if(e.details.period_end_date?(new Date(e.details.period_end_date)).getTime()!==(new Date(t.details.period_end_date)).getTime():!!e.details.period_end_date!=!!t.details.period_end_date){var n=!t.details.period_end_date||new Date(t.details.period_end_date)>new Date;n!=!!+e.$parent.contract.is_current&&(n?(e.$parent.contract.is_current="1",e.$parent.$parent.contractCurrent.push(e.$parent.contract),e.$parent.$parent.contractPast.splice(e.$parent.$parent.contractPast.indexOf(e.$parent.contract),1)):(e.$parent.contract.is_current="0",e.$parent.$parent.contractPast.push(e.$parent.contract),e.$parent.$parent.contractCurrent.splice(e.$parent.$parent.contractCurrent.indexOf(e.$parent.contract),1)))}if(t.revisionCreated){var r=(new Date(t.revisionCreated.effective_date)).setHours(0,0,0,0),i=(new Date(e.revisionCurrent.effective_date)).setHours(0,0,0,0),o=(new Date).setHours(0,0,0,0);(r<=o&&r>=i||i>o&&r<=i)&&b(t),e.revisionList.unshift(t.revisionCreated),e.revisionDataList.unshift({revisionEntityIdObj:t.revisionCreated,details:t.details,hour:t.hour,pay:t.pay})}else{var u=["details","hour","pay"],a,f;b(t),e.contract.is_primary!=t.contract.is_primary&&e.$parent.$parent.toggleIsPrimary(e.contract.id),angular.forEach(e.revisionDataList,function(n){a=0,f={};while(u[a])n.revisionEntityIdObj[u[a]+"_revision_id"]==e.revisionCurrent[u[a]+"_revision_id"]&&(f[u[a]]=t[u[a]],angular.extend(n,f)),a++})}t.files&&(y=s.all({details:d.get(e.details.jobcontract_revision_id,"civicrm_hrjobcontract_details"),pension:d.get(e.pension.jobcontract_revision_id,"civicrm_hrjobcontract_pension")}))})},e.modalRevision=function(t){e.$broadcast("hrjc-loader-show");if(!t)return null;var a=[],f=t!="leave"?"getOne":"get",l=0,c=e.revisionList.length;for(l;l<c;l++)a.push(u[f]("HRJob"+n("capitalize")(t),{jobcontract_revision_id:e.revisionList[l][t+"_revision_id"]}));var h={targetDomEl:i.find("div").eq(0),size:"lg",controller:"ModalRevisionCtrl",templateUrl:o.pathApp+"views/modalRevision.html?v=ergerg",windowClass:"modal-revision",resolve:{entity:function(){return t},fields:function(){return e.$parent.$parent.fields[t]},model:function(){return e.model[t]},utils:function(){return e.utils},revisionDataList:function(){return s.all(a)},revisionList:function(){return e.revisionList},modalContract:function(){return e.modalContract}}};return r.open(h)},e.$on("updateContractView",function(){e.$broadcast("hrjc-loader-show"),s.all({details:a.getOne({jobcontract_revision_id:e.revisionCurrent.details_revision_id}),hour:f.getOne({jobcontract_revision_id:e.revisionCurrent.hour_revision_id}),pay:l.getOne({jobcontract_revision_id:e.revisionCurrent.pay_revision_id}),leave:c.get({jobcontract_revision_id:e.revisionCurrent.leave_revision_id}),health:h.getOne({jobcontract_revision_id:e.revisionCurrent.health_revision_id}),pension:p.getOne({jobcontract_revision_id:e.revisionCurrent.pension_revision_id})}).then(function(t){b(t),e.$broadcast("hrjc-loader-hide")}).then(function(){y=s.all({details:d.get(e.details.jobcontract_revision_id,"civicrm_hrjobcontract_details"),pension:d.get(e.pension.jobcontract_revision_id,"civicrm_hrjobcontract_pension")})})})}])}),define("controllers/revisionList",["controllers/controllers","services/contract"],function(e){e.controller("RevisionListCtrl",["$scope","$filter","$q","$modal","$rootElement","settings","ContractService","ContractDetailsService","ContractHourService","ContractPayService","$log",function(e,t,n,r,i,s,o,u,a,f,l){function p(){var n,r=0;if(e.revisionList.length){var i=t("orderBy")(e.revisionList,["effective_date","id"]);angular.forEach(i,function(e){(new Date(e.effective_date)).setHours(0,0,0,0)<=(new Date).setHours(0,0,0,0)&&(n=e)});if(!n)do n=i[r],r++;while(i[r]&&i[r-1].effective_date==i[r].effective_date);return angular.extend(e.revisionCurrent,n),n.id}return null}function d(r){e.revisionList.length=0,e.revisionDataList.length=0,o.getRevision(r).then(function(r){var i=[];return r=t("orderBy")(r,["-effective_date","-id"]),e.revisionList.push.apply(e.revisionList,r),angular.forEach(r,function(e){e.effective_date=e.effective_date||"",i.push(n.all({revisionEntityIdObj:e,details:u.getOne({jobcontract_revision_id:e.details_revision_id,"return":"position, location"}),hour:a.getOne({jobcontract_revision_id:e.hour_revision_id,"return":"hours_type"}),pay:f.getOne({jobcontract_revision_id:e.pay_revision_id,"return":"pay_scale, pay_annualized_est, pay_currency"})}))}),n.all(i)}).then(function(t){e.revisionDataList.push.apply(e.revisionDataList,t)})}function v(){var t=s.pathReport+(s.pathReport.indexOf("?")>-1?"&":"?"),n=e.fields;return angular.forEach(n,function(e,n){t+="fields["+n+"_revision_id]=1&",angular.forEach(e,function(e){t+="fields["+n+"_"+e.name+"]=1&"})}),t+="fields[sort_name]=1&fields[first_name]=1&fields[last_name]=1&fields[external_identifier]=1&fields[email]=1&fields[street_address]=1&fields[city]=1&fields[name]=1&fields[contract_contact_id]=1&fields[contract_contract_id]=1&fields[jobcontract_revision_id]=1&fields[change_reason]=1&fields[created_date]=1&fields[effective_date]=1&fields[modified_date]=1&order_bys[1][column]=id&order_bys[1][order]=ASC&order_bys[2][column]=civicrm_hrjobcontract_revision_revision_id&order_bys[2][order]=ASC&order_bys[3][column]=-&order_bys[3][order]=ASC&order_bys[4][column]=-&order_bys[4][order]=ASC&order_bys[5][column]=-&order_bys[5][order]=ASC&contract_id_op=eq&permission=access+CiviReport&row_count=&_qf_Summary_submit_csv=Preview+CSV&groups=&contract_id_value="+c+"&group_bys[civicrm_hrjobcontract_revision_revision_id]=1",t}l.debug("Controller: RevisionListCtrl");var c=e.contract.id,h=e.revisionDataList=e.$parent.$parent.$parent.$parent.revisionDataList;e.revisionCurrent=e.$parent.$parent.$parent.$parent.revisionCurrent,e.currentPage=1,e.itemsPerPage=5,e.maxSize=5,e.sortCol="revisionEntityIdObj.effective_date",e.sortReverse=!0,e.createPage=function(){var t=(e.currentPage-1)*e.itemsPerPage,n=t+e.itemsPerPage;e.revisionDataListPage=h.slice(t,n)},e.sortBy=function(n,r){typeof n!="undefined"&&(e.sortCol==n?e.sortReverse=!e.sortReverse:e.sortCol=n),typeof r!="undefined"&&(e.sortReverse=r),h=t("orderBy")(e.revisionDataList,e.sortCol,e.sortReverse)},d(c),e.urlCSV=v(),e.deleteRevision=function(t,n){if(e.revisionList.length==1){n.stopPropagation();return}if(!t||typeof +t!="number")return;var u=r.open({targetDomEl:i.find("div").eq(0),templateUrl:s.pathApp+"views/modalDialog.html",size:"sm",controller:"ModalDialogCtrl",resolve:{content:function(){return{msg:"Are you sure you want to delete this job contract revision?"}}}});u.result.then(function(n){n&&(e.$parent.$parent.$parent.$broadcast("hrjc-loader-show"),o.deleteRevision(t).then(function(n){var r=0,i=e.revisionList.length;if(!n.is_error){for(r;r<i;r++)if(e.revisionList[r].id==t){e.revisionList.splice(r,1),e.revisionDataList.splice(r,1);break}e.sortBy(),e.createPage();if(e.revisionCurrent.id!=p()){e.$emit("updateContractView");return}e.$parent.$parent.$parent.$broadcast("hrjc-loader-hide")}}))})},e.modalRevisionEdit=function(t){var n=t.effective_date,u=t.change_reason,a=r.open({targetDomEl:i.find("div").eq(0),templateUrl:s.pathApp+"views/modalChangeReason.html?v="+(new Date).getTime(),controller:"ModalChangeReasonCtrl",resolve:{content:function(){return{copy:{title:"Edit revision data"}}},date:function(){return n},reasonId:function(){return u}}});a.result.then(function(r){(r.date!=n||r.reasonId!=u)&&o.saveRevision({id:t.id,change_reason:r.reasonId,effective_date:r.date}).then(function(){t.effective_date=r.date,t.change_reason=r.reasonId,e.sortBy(),e.createPage(),e.revisionCurrent.id!=p()&&e.$emit("updateContractView")})})},e.$watch("currentPage",function(){e.createPage()}),e.$watch("revisionDataList.length",function(t,n){h=e.revisionDataList,t>n&&p(),e.sortBy(),e.createPage()})}])}),function(t){function n(e,t,n){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:n;default:throw new Error("Implement me")}}function r(e,t){return Ct.call(e,t)}function i(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function s(e){wt.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function o(e,t){var n=!0;return p(function(){return n&&(s(e),n=!1),t.apply(this,arguments)},t)}function u(e,t){yn[e]||(s(t),yn[e]=!0)}function a(e,t){return function(n){return m(e.call(this,n),t)}}function f(e,t){return function(n){return this.localeData().ordinal(e.call(this,n),t)}}function l(){}function c(e,t){t!==!1&&_(e),d(this,e),this._d=new Date(+e._d)}function h(e){var t=N(e),n=t.year||0,r=t.quarter||0,i=t.month||0,s=t.week||0,o=t.day||0,u=t.hour||0,a=t.minute||0,f=t.second||0,l=t.millisecond||0;this._milliseconds=+l+1e3*f+6e4*a+36e5*u,this._days=+o+7*s,this._months=+i+3*r+12*n,this._data={},this._locale=wt.localeData(),this._bubble()}function p(e,t){for(var n in t)r(t,n)&&(e[n]=t[n]);return r(t,"toString")&&(e.toString=t.toString),r(t,"valueOf")&&(e.valueOf=t.valueOf),e}function d(e,t){var n,r,i;if("undefined"!=typeof t._isAMomentObject&&(e._isAMomentObject=t._isAMomentObject),"undefined"!=typeof t._i&&(e._i=t._i),"undefined"!=typeof t._f&&(e._f=t._f),"undefined"!=typeof t._l&&(e._l=t._l),"undefined"!=typeof t._strict&&(e._strict=t._strict),"undefined"!=typeof t._tzm&&(e._tzm=t._tzm),"undefined"!=typeof t._isUTC&&(e._isUTC=t._isUTC),"undefined"!=typeof t._offset&&(e._offset=t._offset),"undefined"!=typeof t._pf&&(e._pf=t._pf),"undefined"!=typeof t._locale&&(e._locale=t._locale),Ht.length>0)for(n in Ht)r=Ht[n],i=t[r],"undefined"!=typeof i&&(e[r]=i);return e}function v(e){return 0>e?Math.ceil(e):Math.floor(e)}function m(e,t,n){for(var r=""+Math.abs(e),i=e>=0;r.length<t;)r="0"+r;return(i?n?"+":"":"-")+r}function g(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t- +e.clone().add(n.months,"M"),n}function y(e,t){var n;return t=j(t,e),e.isBefore(t)?n=g(e,t):(n=g(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function b(e,t){return function(n,r){var i,s;return null===r||isNaN(+r)||(u(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),s=n,n=r,r=s),n="string"==typeof n?+n:n,i=wt.duration(n,r),w(this,i,e),this}}function w(e,t,n,r){var i=t._milliseconds,s=t._days,o=t._months;r=null==r?!0:r,i&&e._d.setTime(+e._d+i*n),s&&dt(e,"Date",pt(e,"Date")+s*n),o&&ht(e,pt(e,"Month")+o*n),r&&wt.updateOffset(e,s||o)}function E(e){return"[object Array]"===Object.prototype.toString.call(e)}function S(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function x(e,t,n){var r,i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),o=0;for(r=0;i>r;r++)(n&&e[r]!==t[r]||!n&&k(e[r])!==k(t[r]))&&o++;return o+s}function T(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=cn[e]||hn[t]||t}return e}function N(e){var t,n,i={};for(n in e)r(e,n)&&(t=T(n),t&&(i[t]=e[n]));return i}function C(e){var n,r;if(0===e.indexOf("week"))n=7,r="day";else{if(0!==e.indexOf("month"))return;n=12,r="month"}wt[e]=function(i,s){var o,u,a=wt._locale[e],f=[];if("number"==typeof i&&(s=i,i=t),u=function(e){var t=wt().utc().set(r,e);return a.call(wt._locale,t,i||"")},null!=s)return u(s);for(o=0;n>o;o++)f.push(u(o));return f}}function k(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function L(e,t){return(new Date(Date.UTC(e,t+1,0))).getUTCDate()}function A(e,t,n){return at(wt([e,11,31+t-n]),t,n).week}function O(e){return M(e)?366:365}function M(e){return e%4===0&&e%100!==0||e%400===0}function _(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[Lt]<0||e._a[Lt]>11?Lt:e._a[At]<1||e._a[At]>L(e._a[kt],e._a[Lt])?At:e._a[Ot]<0||e._a[Ot]>24||24===e._a[Ot]&&(0!==e._a[Mt]||0!==e._a[_t]||0!==e._a[Dt])?Ot:e._a[Mt]<0||e._a[Mt]>59?Mt:e._a[_t]<0||e._a[_t]>59?_t:e._a[Dt]<0||e._a[Dt]>999?Dt:-1,e._pf._overflowDayOfYear&&(kt>t||t>At)&&(t=At),e._pf.overflow=t)}function D(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length&&e._pf.bigHour===t)),e._isValid}function P(e){return e?e.toLowerCase().replace("_","-"):e}function H(e){for(var t,n,r,i,s=0;s<e.length;){for(i=P(e[s]).split("-"),t=i.length,n=P(e[s+1]),n=n?n.split("-"):null;t>0;){if(r=B(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&x(i,n,!0)>=t-1)break;t--}s++}return null}function B(e){var t=null;if(!Pt[e]&&Bt)try{t=wt.locale(),require("./locale/"+e),wt.locale(t)}catch(n){}return Pt[e]}function j(e,t){var n,r;return t._isUTC?(n=t.clone(),r=(wt.isMoment(e)||S(e)?+e:+wt(e))- +n,n._d.setTime(+n._d+r),wt.updateOffset(n,!1),n):wt(e).local()}function F(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function I(e){var t,n,r=e.match(qt);for(t=0,n=r.length;n>t;t++)r[t]=gn[r[t]]?gn[r[t]]:F(r[t]);return function(i){var s="";for(t=0;n>t;t++)s+=r[t]instanceof Function?r[t].call(i,e):r[t];return s}}function q(e,t){return e.isValid()?(t=R(t,e.localeData()),pn[t]||(pn[t]=I(t)),pn[t](e)):e.localeData().invalidDate()}function R(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Rt.lastIndex=0;r>=0&&Rt.test(e);)e=e.replace(Rt,n),Rt.lastIndex=0,r-=1;return e}function U(e,t){var n,r=t._strict;switch(e){case"Q":return Yt;case"DDDD":return en;case"YYYY":case"GGGG":case"gggg":return r?tn:Wt;case"Y":case"G":case"g":return rn;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return r?nn:Xt;case"S":if(r)return Yt;case"SS":if(r)return Zt;case"SSS":if(r)return en;case"DDD":return zt;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return $t;case"a":case"A":return t._locale._meridiemParse;case"x":return Qt;case"X":return Gt;case"Z":case"ZZ":return Jt;case"T":return Kt;case"SSSS":return Vt;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return r?Zt:Ut;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Ut;case"Do":return r?t._locale._ordinalParse:t._locale._ordinalParseLenient;default:return n=new RegExp(G(Q(e.replace("\\","")),"i"))}}function z(e){e=e||"";var t=e.match(Jt)||[],n=t[t.length-1]||[],r=(n+"").match(fn)||["-",0,0],i=+(60*r[1])+k(r[2]);return"+"===r[0]?-i:i}function W(e,t,n){var r,i=n._a;switch(e){case"Q":null!=t&&(i[Lt]=3*(k(t)-1));break;case"M":case"MM":null!=t&&(i[Lt]=k(t)-1);break;case"MMM":case"MMMM":r=n._locale.monthsParse(t,e,n._strict),null!=r?i[Lt]=r:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(i[At]=k(t));break;case"Do":null!=t&&(i[At]=k(parseInt(t.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=k(t));break;case"YY":i[kt]=wt.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":i[kt]=k(t);break;case"a":case"A":n._isPm=n._locale.isPM(t);break;case"h":case"hh":n._pf.bigHour=!0;case"H":case"HH":i[Ot]=k(t);break;case"m":case"mm":i[Mt]=k(t);break;case"s":case"ss":i[_t]=k(t);break;case"S":case"SS":case"SSS":case"SSSS":i[Dt]=k(1e3*("0."+t));break;case"x":n._d=new Date(k(t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=z(t);break;case"dd":case"ddd":case"dddd":r=n._locale.weekdaysParse(t),null!=r?(n._w=n._w||{},n._w.d=r):n._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=k(t));break;case"gg":case"GG":n._w=n._w||{},n._w[e]=wt.parseTwoDigitYear(t)}}function X(e){var t,r,i,s,o,u,a;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(o=1,u=4,r=n(t.GG,e._a[kt],at(wt(),1,4).year),i=n(t.W,1),s=n(t.E,1)):(o=e._locale._week.dow,u=e._locale._week.doy,r=n(t.gg,e._a[kt],at(wt(),o,u).year),i=n(t.w,1),null!=t.d?(s=t.d,o>s&&++i):s=null!=t.e?t.e+o:o),a=ft(r,i,s,u,o),e._a[kt]=a.year,e._dayOfYear=a.dayOfYear}function V(e){var t,r,i,s,o=[];if(!e._d){for(i=J(e),e._w&&null==e._a[At]&&null==e._a[Lt]&&X(e),e._dayOfYear&&(s=n(e._a[kt],i[kt]),e._dayOfYear>O(s)&&(e._pf._overflowDayOfYear=!0),r=it(s,0,e._dayOfYear),e._a[Lt]=r.getUTCMonth(),e._a[At]=r.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;7>t;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Ot]&&0===e._a[Mt]&&0===e._a[_t]&&0===e._a[Dt]&&(e._nextDay=!0,e._a[Ot]=0),e._d=(e._useUTC?it:rt).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm),e._nextDay&&(e._a[Ot]=24)}}function $(e){var t;e._d||(t=N(e._i),e._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],V(e))}function J(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function K(e){if(e._f===wt.ISO_8601)return void Z(e);e._a=[],e._pf.empty=!0;var n,r,i,s,o,u=""+e._i,a=u.length,f=0;for(i=R(e._f,e._locale).match(qt)||[],n=0;n<i.length;n++)s=i[n],r=(u.match(U(s,e))||[])[0],r&&(o=u.substr(0,u.indexOf(r)),o.length>0&&e._pf.unusedInput.push(o),u=u.slice(u.indexOf(r)+r.length),f+=r.length),gn[s]?(r?e._pf.empty=!1:e._pf.unusedTokens.push(s),W(s,r,e)):e._strict&&!r&&e._pf.unusedTokens.push(s);e._pf.charsLeftOver=a-f,u.length>0&&e._pf.unusedInput.push(u),e._pf.bigHour===!0&&e._a[Ot]<=12&&(e._pf.bigHour=t),e._isPm&&e._a[Ot]<12&&(e._a[Ot]+=12),e._isPm===!1&&12===e._a[Ot]&&(e._a[Ot]=0),V(e),_(e)}function Q(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})}function G(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Y(e){var t,n,r,s,o;if(0===e._f.length)return e._pf.invalidFormat=!0,void (e._d=new Date(0/0));for(s=0;s<e._f.length;s++)o=0,t=d({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._pf=i(),t._f=e._f[s],K(t),D(t)&&(o+=t._pf.charsLeftOver,o+=10*t._pf.unusedTokens.length,t._pf.score=o,(null==r||r>o)&&(r=o,n=t));p(e,n||t)}function Z(e){var t,n,r=e._i,i=sn.exec(r);if(i){for(e._pf.iso=!0,t=0,n=un.length;n>t;t++)if(un[t][1].exec(r)){e._f=un[t][0]+(i[6]||" ");break}for(t=0,n=an.length;n>t;t++)if(an[t][1].exec(r)){e._f+=an[t][0];break}r.match(Jt)&&(e._f+="Z"),K(e)}else e._isValid=!1}function et(e){Z(e),e._isValid===!1&&(delete e._isValid,wt.createFromInputFallback(e))}function tt(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function nt(e){var n,r=e._i;r===t?e._d=new Date:S(r)?e._d=new Date(+r):null!==(n=jt.exec(r))?e._d=new Date(+n[1]):"string"==typeof r?et(e):E(r)?(e._a=tt(r.slice(0),function(e){return parseInt(e,10)}),V(e)):"object"==typeof r?$(e):"number"==typeof r?e._d=new Date(r):wt.createFromInputFallback(e)}function rt(e,t,n,r,i,s,o){var u=new Date(e,t,n,r,i,s,o);return 1970>e&&u.setFullYear(e),u}function it(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function st(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function ot(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function ut(e,t,n){var r=wt.duration(e).abs(),i=Nt(r.as("s")),s=Nt(r.as("m")),o=Nt(r.as("h")),u=Nt(r.as("d")),a=Nt(r.as("M")),f=Nt(r.as("y")),l=i<dn.s&&["s",i]||1===s&&["m"]||s<dn.m&&["mm",s]||1===o&&["h"]||o<dn.h&&["hh",o]||1===u&&["d"]||u<dn.d&&["dd",u]||1===a&&["M"]||a<dn.M&&["MM",a]||1===f&&["y"]||["yy",f];return l[2]=t,l[3]=+e>0,l[4]=n,ot.apply({},l)}function at(e,t,n){var r,i=n-t,s=n-e.day();return s>i&&(s-=7),i-7>s&&(s+=7),r=wt(e).add(s,"d"),{week:Math.ceil(r.dayOfYear()/7),year:r.year()}}function ft(e,t,n,r,i){var s,o,u=it(e,0,1).getUTCDay();return u=0===u?7:u,n=null!=n?n:i,s=i-u+(u>r?7:0)-(i>u?7:0),o=7*(t-1)+(n-i)+s+1,{year:o>0?e:e-1,dayOfYear:o>0?o:O(e-1)+o}}function lt(e){var n,r=e._i,i=e._f;return e._locale=e._locale||wt.localeData(e._l),null===r||i===t&&""===r?wt.invalid({nullInput:!0}):("string"==typeof r&&(e._i=r=e._locale.preparse(r)),wt.isMoment(r)?new c(r,!0):(i?E(i)?Y(e):K(e):nt(e),n=new c(e),n._nextDay&&(n.add(1,"d"),n._nextDay=t),n))}function ct(e,t){var n,r;if(1===t.length&&E(t[0])&&(t=t[0]),!t.length)return wt();for(n=t[0],r=1;r<t.length;++r)t[r][e](n)&&(n=t[r]);return n}function ht(e,t){var n;return"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),L(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function pt(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function dt(e,t,n){return"Month"===t?ht(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function vt(e,t){return function(n){return null!=n?(dt(this,e,n),wt.updateOffset(this,t),this):pt(this,e)}}function mt(e){return 400*e/146097}function gt(e){return 146097*e/400}function yt(e){wt.duration.fn[e]=function(){return this._data[e]}}function bt(e){"undefined"==typeof ender&&(Et=Tt.moment,Tt.moment=e?o("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",wt):wt)}for(var wt,Et,St,xt="2.8.4",Tt="undefined"!=typeof global?global:this,Nt=Math.round,Ct=Object.prototype.hasOwnProperty,kt=0,Lt=1,At=2,Ot=3,Mt=4,_t=5,Dt=6,Pt={},Ht=[],Bt="undefined"!=typeof e&&e&&e.exports,jt=/^\/?Date\((\-?\d+)/i,Ft=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,It=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,qt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,Rt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ut=/\d\d?/,zt=/\d{1,3}/,Wt=/\d{1,4}/,Xt=/[+\-]?\d{1,6}/,Vt=/\d+/,$t=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Jt=/Z|[\+\-]\d\d:?\d\d/gi,Kt=/T/i,Qt=/[\+\-]?\d+/,Gt=/[\+\-]?\d+(\.\d{1,3})?/,Yt=/\d/,Zt=/\d\d/,en=/\d{3}/,tn=/\d{4}/,nn=/[+-]?\d{6}/,rn=/[+-]?\d+/,sn=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,on="YYYY-MM-DDTHH:mm:ssZ",un=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],an=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],fn=/([\+\-]|\d\d)/gi,ln=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),cn={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},hn={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},pn={},dn={s:45,m:45,h:22,d:26,M:11},vn="DDD w W M D d".split(" "),mn="M D H h m s w W".split(" "),gn={M:function(){return this.month()+1},MMM:function(e){return this.localeData().monthsShort(this,e)},MMMM:function(e){return this.localeData().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.localeData().weekdaysMin(this,e)},ddd:function(e){return this.localeData().weekdaysShort(this,e)},dddd:function(e){return this.localeData().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return m(this.year()%100,2)},YYYY:function(){return m(this.year(),4)},YYYYY:function(){return m(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+m(Math.abs(e),6)},gg:function(){return m(this.weekYear()%100,2)},gggg:function(){return m(this.weekYear(),4)},ggggg:function(){return m(this.weekYear(),5)},GG:function(){return m(this.isoWeekYear()%100,2)},GGGG:function(){return m(this.isoWeekYear(),4)},GGGGG:function(){return m(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return k(this.milliseconds()/100)},SS:function(){return m(k(this.milliseconds()/10),2)},SSS:function(){return m(this.milliseconds(),3)},SSSS:function(){return m(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+m(k(e/60),2)+":"+m(k(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+m(k(e/60),2)+m(k(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},yn={},bn=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];vn.length;)St=vn.pop(),gn[St+"o"]=f(gn[St],St);for(;mn.length;)St=mn.pop(),gn[St+St]=a(gn[St],2);gn.DDDD=a(gn.DDD,3),p(l.prototype,{set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e,t,n){var r,i,s;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;12>r;r++){if(i=wt.utc([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,r;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=wt([2e3,1]).day(t),r="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t,n){var r=this._calendar[e];return"function"==typeof r?r.apply(t,[n]):r},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return"function"==typeof i?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(e){return e},postformat:function(e){return e},week:function(e){return at(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),wt=function(e,n,r,s){var o;return"boolean"==typeof r&&(s=r,r=t),o={},o._isAMomentObject=!0,o._i=e,o._f=n,o._l=r,o._strict=s,o._isUTC=!1,o._pf=i(),lt(o)},wt.suppressDeprecationWarnings=!1,wt.createFromInputFallback=o("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),wt.min=function(){var e=[].slice.call(arguments,0);return ct("isBefore",e)},wt.max=function(){var e=[].slice.call(arguments,0);return ct("isAfter",e)},wt.utc=function(e,n,r,s){var o;return"boolean"==typeof r&&(s=r,r=t),o={},o._isAMomentObject=!0,o._useUTC=!0,o._isUTC=!0,o._l=r,o._i=e,o._f=n,o._strict=s,o._pf=i(),lt(o).utc()},wt.unix=function(e){return wt(1e3*e)},wt.duration=function(e,t){var n,i,s,o,u=e,a=null;return wt.isDuration(e)?u={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(u={},t?u[t]=e:u.milliseconds=e):(a=Ft.exec(e))?(n="-"===a[1]?-1:1,u={y:0,d:k(a[At])*n,h:k(a[Ot])*n,m:k(a[Mt])*n,s:k(a[_t])*n,ms:k(a[Dt])*n}):(a=It.exec(e))?(n="-"===a[1]?-1:1,s=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*n},u={y:s(a[2]),M:s(a[3]),d:s(a[4]),h:s(a[5]),m:s(a[6]),s:s(a[7]),w:s(a[8])}):"object"==typeof u&&("from"in u||"to"in u)&&(o=y(wt(u.from),wt(u.to)),u={},u.ms=o.milliseconds,u.M=o.months),i=new h(u),wt.isDuration(e)&&r(e,"_locale")&&(i._locale=e._locale),i},wt.version=xt,wt.defaultFormat=on,wt.ISO_8601=function(){},wt.momentProperties=Ht,wt.updateOffset=function(){},wt.relativeTimeThreshold=function(e,n){return dn[e]===t?!1:n===t?dn[e]:(dn[e]=n,!0)},wt.lang=o("moment.lang is deprecated. Use moment.locale instead.",function(e,t){return wt.locale(e,t)}),wt.locale=function(e,t){var n;return e&&(n="undefined"!=typeof t?wt.defineLocale(e,t):wt.localeData(e),n&&(wt.duration._locale=wt._locale=n)),wt._locale._abbr},wt.defineLocale=function(e,t){return null!==t?(t.abbr=e,Pt[e]||(Pt[e]=new l),Pt[e].set(t),wt.locale(e),Pt[e]):(delete Pt[e],null)},wt.langData=o("moment.langData is deprecated. Use moment.localeData instead.",function(e){return wt.localeData(e)}),wt.localeData=function(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return wt._locale;if(!E(e)){if(t=B(e))return t;e=[e]}return H(e)},wt.isMoment=function(e){return e instanceof c||null!=e&&r(e,"_isAMomentObject")},wt.isDuration=function(e){return e instanceof h};for(St=bn.length-1;St>=0;--St)C(bn[St]);wt.normalizeUnits=function(e){return T(e)},wt.invalid=function(e){var t=wt.utc(0/0);return null!=e?p(t._pf,e):t._pf.userInvalidated=!0,t},wt.parseZone=function(){return wt.apply(null,arguments).parseZone()},wt.parseTwoDigitYear=function(e){return k(e)+(k(e)>68?1900:2e3)},p(wt.fn=c.prototype,{clone:function(){return wt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=wt(this).utc();return 0<e.year()&&e.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():q(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):q(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return D(this)},isDSTShifted:function(){return this._a?this.isValid()&&x(this._a,(this._isUTC?wt.utc(this._a):wt(this._a)).toArray())>0:!1},parsingFlags:function(){return p({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._dateTzOffset(),"m")),this},format:function(e){var t=q(this,e||wt.defaultFormat);return this.localeData().postformat(t)},add:b(1,"add"),subtract:b(-1,"subtract"),diff:function(e,t,n){var r,i,s,o=j(e,this),u=6e4*(this.zone()-o.zone());return t=T(t),"year"===t||"month"===t?(r=432e5*(this.daysInMonth()+o.daysInMonth()),i=12*(this.year()-o.year())+(this.month()-o.month()),s=this-wt(this).startOf("month")-(o-wt(o).startOf("month")),s-=6e4*(this.zone()-wt(this).startOf("month").zone()-(o.zone()-wt(o).startOf("month").zone())),i+=s/r,"year"===t&&(i/=12)):(r=this-o,i="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-u)/864e5:"week"===t?(r-u)/6048e5:r),n?i:v(i)},from:function(e,t){return wt.duration({to:this,from:e}).locale(this.locale()).humanize(!t)},fromNow:function(e){return this.from(wt(),e)},calendar:function(e){var t=e||wt(),n=j(t,this).startOf("day"),r=this.diff(n,"days",!0),i=-6>r?"sameElse":-1>r?"lastWeek":0>r?"lastDay":1>r?"sameDay":2>r?"nextDay":7>r?"nextWeek":"sameElse";return this.format(this.localeData().calendar(i,this,wt(t)))},isLeapYear:function(){return M(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=st(e,this.localeData()),this.add(e-t,"d")):t},month:vt("Month",!0),startOf:function(e){switch(e=T(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=T(e),e===t||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")},isAfter:function(e,t){var n;return t=T("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=wt.isMoment(e)?e:wt(e),+this>+e):(n=wt.isMoment(e)?+e:+wt(e),n<+this.clone().startOf(t))},isBefore:function(e,t){var n;return t=T("undefined"!=typeof t?t:"millisecond"),"millisecond"===t?(e=wt.isMoment(e)?e:wt(e),+e>+this):(n=wt.isMoment(e)?+e:+wt(e),+this.clone().endOf(t)<n)},isSame:function(e,t){var n;return t=T(t||"millisecond"),"millisecond"===t?(e=wt.isMoment(e)?e:wt(e),+this===+e):(n=+wt(e),+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))},min:o("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=wt.apply(null,arguments),this>e?this:e}),max:o("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=wt.apply(null,arguments),e>this?this:e}),zone:function(e,t){var n,r=this._offset||0;return null==e?this._isUTC?r:this._dateTzOffset():("string"==typeof e&&(e=z(e)),Math.abs(e)<16&&(e=60*e),!this._isUTC&&t&&(n=this._dateTzOffset()),this._offset=e,this._isUTC=!0,null!=n&&this.subtract(n,"m"),r!==e&&(!t||this._changeInProgress?w(this,wt.duration(r-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,wt.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?wt(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return L(this.year(),this.month())},dayOfYear:function(e){var t=Nt((wt(this).startOf("day")-wt(this).startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=at(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==e?t:this.add(e-t,"y")},isoWeekYear:function(e){var t=at(this,1,4).year;return null==e?t:this.add(e-t,"y")},week:function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},isoWeek:function(e){var t=at(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},weekday:function(e){var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return A(this.year(),1,4)},weeksInYear:function(){var e=this.localeData()._week;return A(this.year(),e.dow,e.doy)},get:function(e){return e=T(e),this[e]()},set:function(e,t){return e=T(e),"function"==typeof this[e]&&this[e](t),this},locale:function(e){var n;return e===t?this._locale._abbr:(n=wt.localeData(e),null!=n&&(this._locale=n),this)},lang:o("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===t?this.localeData():this.locale(e)}),localeData:function(){return this._locale},_dateTzOffset:function(){return 15*Math.round(this._d.getTimezoneOffset()/15)}}),wt.fn.millisecond=wt.fn.milliseconds=vt("Milliseconds",!1),wt.fn.second=wt.fn.seconds=vt("Seconds",!1),wt.fn.minute=wt.fn.minutes=vt("Minutes",!1),wt.fn.hour=wt.fn.hours=vt("Hours",!0),wt.fn.date=vt("Date",!0),wt.fn.dates=o("dates accessor is deprecated. Use date instead.",vt("Date",!0)),wt.fn.year=vt("FullYear",!0),wt.fn.years=o("years accessor is deprecated. Use year instead.",vt("FullYear",!0)),wt.fn.days=wt.fn.day,wt.fn.months=wt.fn.month,wt.fn.weeks=wt.fn.week,wt.fn.isoWeeks=wt.fn.isoWeek,wt.fn.quarters=wt.fn.quarter,wt.fn.toJSON=wt.fn.toISOString,p(wt.duration.fn=h.prototype,{_bubble:function(){var e,t,n,r=this._milliseconds,i=this._days,s=this._months,o=this._data,u=0;o.milliseconds=r%1e3,e=v(r/1e3),o.seconds=e%60,t=v(e/60),o.minutes=t%60,n=v(t/60),o.hours=n%24,i+=v(n/24),u=v(mt(i)),i-=v(gt(u)),s+=v(i/30),i%=30,u+=v(s/12),s%=12,o.days=i,o.months=s,o.years=u},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return v(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*k(this._months/12)},humanize:function(e){var t=ut(this,!e,this.localeData());return e&&(t=this.localeData().pastFuture(+this,t)),this.localeData().postformat(t)},add:function(e,t){var n=wt.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=wt.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=T(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;if(e=T(e),"month"===e||"year"===e)return t=this._days+this._milliseconds/864e5,n=this._months+12*mt(t),"month"===e?n:n/12;switch(t=this._days+Math.round(gt(this._months/12)),e){case"week":return t/7+this._milliseconds/6048e5;case"day":return t+this._milliseconds/864e5;case"hour":return 24*t+this._milliseconds/36e5;case"minute":return 24*t*60+this._milliseconds/6e4;case"second":return 24*t*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*t*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+e)}},lang:wt.fn.lang,locale:wt.fn.locale,toIsoString:o("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),r=Math.abs(this.hours()),i=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(r||i||s?"T":"")+(r?r+"H":"")+(i?i+"M":"")+(s?s+"S":""):"P0D"},localeData:function(){return this._locale}}),wt.duration.fn.toString=wt.duration.fn.toISOString;for(St in ln)r(ln,St)&&yt(St.toLowerCase());wt.duration.fn.asMilliseconds=function(){return this.as("ms")},wt.duration.fn.asSeconds=function(){return this.as("s")},wt.duration.fn.asMinutes=function(){return this.as("m")},wt.duration.fn.asHours=function(){return this.as("h")},wt.duration.fn.asDays=function(){return this.as("d")},wt.duration.fn.asWeeks=function(){return this.as("weeks")},wt.duration.fn.asMonths=function(){return this.as("M")},wt.duration.fn.asYears=function(){return this.as("y")},wt.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===k(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),Bt?e.exports=wt:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(e,t,n){return n.config&&n.config()&&n.config().noGlobal===!0&&(Tt.moment=Et),wt}),bt(!0)):bt()}.call(this),define("controllers/modal/modalChangeReason",["controllers/controllers","moment"],function(e,t){e.controller("ModalChangeReasonCtrl",["$scope","$modalInstance","content","date","reasonId","$log",function(e,n,r,i,s,o){o.debug("Controller: ModalChangeReasonCtrl");var r=r||{},u=r.copy||{};u.title=u.title||"Revision data",e.change_reason=s||"",e.copy=u,e.effective_date=i||"",e.isPast=!1,e.dpOpen=function(t,n){t.preventDefault(),t.stopPropagation(),e[n]=!0},e.save=function(){n.close({reasonId:e.change_reason,date:e.effective_date?t(e.effective_date).format("YYYY-MM-DD"):""})},e.cancel=function(){n.dismiss("cancel")},e.$watch("effective_date",function(t){e.isPast=new Date(t)<new Date})}])}),define("services/contractFiles",["services/services","services/utils"],function(e){e.factory("ContractFilesService",["$resource","settings","$q","UtilsService","FileUploader","$log",function(e,t,n,r,i,s){s.debug("Service: ContractFilesService");var o=e(t.pathFile+":action");return i.prototype.queueDelete=[],{"delete":function(e,t,i){if(!e||typeof +e!="number"||!t||typeof +t!="number"||!i||typeof i!="string")return null;var s=n.defer();return o.save({action:"delete",entityTable:i,entityID:t,fileID:e},null,function(e){e.values&&!+e.values[0].result&&(e.is_error=1);if(r.errorHandler(e,"Unable to delete file",s))return;s.resolve(e.values[0])},function(){s.reject("Unable to delete file")}),s.promise},get:function(e,t){if(!e||typeof +e!="number"||!t||typeof t!="string")return null;var i=n.defer();return o.get({action:"list",entityTable:t,entityID:e},function(e){if(r.errorHandler(e,"Unable to fetch files",i))return;i.resolve(e.values)},function(){i.reject("Unable to fetch files")}),i.promise},uploader:function(e,n){if(!e||typeof e!="string")return null;var r={url:t.pathFile+"upload",formData:[{entityTable:e}]};return n&&typeof n=="number"&&(r.queueLimit=n),new i(r)},upload:function(e,t){if(!e||typeof e!="object"||!t||typeof +t!="number")return null;var r=n.defer(),i=[];return e.onBeforeUploadItem=function(e){e.formData.push({entityID:t})},e.onCompleteItem=function(e,t){i.push(t)},e.onErrorItem=function(e,t,n,i){r.reject("Could not upload file: "+e.file.name),s.error(" ===== Item Error: "+n+" ======"),s.error(" =====  - item ======"),s.error(e),s.error(" =====  - response ======"),s.error(t),s.error(" =====  - headers ======"),s.error(i)},e.onCompleteAll=function(){r.resolve(i)},e.uploadAll(),r.promise}}}])}),define("controllers/modal/modalContract",["controllers/controllers","services/contract","services/contractDetails","services/contractHour","services/contractPay","services/contractLeave","services/contractHealth","services/contractPension","services/contractFiles","services/utils"],function(e){e.controller("ModalContractCtrl",["$scope","$modal","$modalInstance","$q","$rootElement","$rootScope","$filter","ContractService","ContractDetailsService","ContractHourService","ContractPayService","ContractLeaveService","ContractHealthService","ContractPensionService","ContractFilesService","action","entity","content","files","UtilsService","utils","settings","$log",function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){S.debug("Controller: ModalContractCtrl");var g=g||{},x=g.copy||{},v=v||"view";x.close=x.close||"Close",x.save=x.save||"Save changes",x.title=x.title||"Contract",e.allowSave=typeof g.allowSave!="undefined"?g.allowSave:!1,e.entity={},e.copy=x,e.files={},e.filesTrash={},e.isDisabled=typeof g.isDisabled!="undefined"?g.isDisabled:!0,e.isPrimaryDisabled=+m.contract.is_primary,e.showIsPrimary=w.contractListLen>1&&v!="change",e.uploader={details:{contract_file:d.uploader("civicrm_hrjobcontract_details")},pension:{evidence_file:d.uploader("civicrm_hrjobcontract_pension",1)}},e.utils=w,angular.copy(m,e.entity),angular.copy(y,e.files),angular.forEach(e.files,function(t,n){e.filesTrash[n]=[]}),n.opened.then(function(){s.$broadcast("hrjc-loader-hide")}),e.cancel=function(){if(v=="view"||angular.equals(m,e.entity)&&angular.equals(y,e.files)&&!e.uploader.details.contract_file.queue.length&&!e.uploader.pension.evidence_file.queue.length){e.$broadcast("hrjc-loader-hide"),n.dismiss("cancel");return}E.debug&&angular.forEach(m,function(t,n){angular.equals(t,e.entity[n])||(S.debug("======================"),S.debug("Changed entity: "+n),S.debug("Before:"),S.debug(t),S.debug("After:"),S.debug(e.entity[n]))});var r=t.open({targetDomEl:i.find("div").eq(0),templateUrl:E.pathApp+"views/modalDialog.html?v="+(new Date).getTime(),size:"sm",controller:"ModalDialogCtrl",resolve:{content:function(){return{copyCancel:"No",title:"Alert",msg:"Are you sure you want to cancel? Changes will be lost!"}}}});r.result.then(function(t){t&&(e.$broadcast("hrjc-loader-hide"),n.dismiss("cancel"))})},e.fileMoveToTrash=function(t,n){var r=e.files[n],i=e.filesTrash[n];i.push(r[t]),r.splice(t,1)};if(e.allowSave){function T(){var e=t.open({targetDomEl:i.find("div").eq(0),templateUrl:E.pathApp+"views/modalChangeReason.html?v="+(new Date).getTime(),controller:"ModalChangeReasonCtrl",resolve:{content:function(){return{copy:{title:x.title}}},date:null,reasonId:null}});return e.result}function N(){var e=t.open({targetDomEl:i.find("div").eq(0),templateUrl:E.pathApp+"views/modalConfirmEdit.html?v="+(new Date).getTime(),controller:"ModalDialogCtrl",resolve:{content:function(){return{msg:"Save without making a new revision?"}}}});return e.result}function C(){e.$broadcast("hrjc-loader-show");var s=e.entity,o=e.filesTrash,v=e.uploader,m,g,y,b,w,S={contract:u.save(s.contract),details:a.save(s.details),hour:f.save(s.hour),pay:l.save(s.pay),leave:c.save(s.leave),health:h.save(s.health),pension:p.save(s.pension)},x=[],T=[];for(m in o){y=0,b=o[m].length;for(y;y<b;y++)g=o[m][y],T.push(d.delete(g.fileID,g.entityID,g.entityTable))}angular.extend(S,{files:T.length?r.all(T):!1}),r.all(S).then(function(e){return v.details.contract_file.queue.length&&x.push(d.upload(v.details.contract_file,s.details.jobcontract_revision_id)),v.pension.evidence_file.queue.length&&x.push(d.upload(v.pension.evidence_file,s.pension.jobcontract_revision_id)),e.details.period_start_date=s.details.period_start_date,e.details.period_end_date=s.details.period_end_date,e.pay.annual_benefits=s.pay.annual_benefits,e.pay.annual_deductions=s.pay.annual_deductions,x.length?(w=t.open({targetDomEl:i.find("div").eq(0),templateUrl:E.pathApp+"views/modalProgress.html?v="+(new Date).getTime(),size:"sm",controller:"ModalProgressCtrl",resolve:{uploader:function(){return v},promiseFilesUpload:function(){return x}}}),e.files=w.result,r.all(e)):e}).then(function(t){e.$broadcast("hrjc-loader-hide"),n.close(t)},function(t){e.$broadcast("hrjc-loader-hide"),CRM.alert(t,"Error","error"),n.dismiss()})}function k(s,o){e.$broadcast("hrjc-loader-show");var v=e.entity,g=e.filesTrash,y=e.uploader,w,S,x,T,N=[],C=0,k,L=0,A,O,M={},_=[],D=[],P,H={details:a,hour:f,pay:l,leave:c,health:h,pension:p};for(w in H){A=!angular.equals(m[w],v[w]);if(!A){A=!!g[w]&&!!g[w].length;if(!A&&y[w])for(x in y[w]){S=y[w][x];if(S.queue.length){A=!0;break}}}A&&(N[L]={},N[L].name=w,N[L].data=v[w],N[L].service=H[w],L++,C=L)}C?(b.prepareEntityIds(N[0].data,m.contract.id),N[0].service.save(N[0].data).then(function(e){P=angular.isArray(e)?e[0].jobcontract_revision_id:e.jobcontract_revision_id,L=1,M[N[0].name]=e;for(L;L<C;L++)w=N[L].name,b.prepareEntityIds(N[L].data,m.contract.id,P),M[w]=N[L].service.save(N[L].data);return r.all(angular.extend(M,{revisionCreated:u.saveRevision({id:P,change_reason:s,effective_date:o})},{files:!1}))}).then(function(e){for(w in H){e[w]=e[w]||v[w];if(g[w]&&g[w].length){L=0,k=g[w].length;for(L;L<k;L++)T=g[w][L],_.push(d.delete(T.fileID,P,T.entityTable))}}return e.details.period_start_date=v.details.period_start_date,e.details.period_end_date=v.details.period_end_date,e.revisionCreated.effective_date=o||"",e.pay.annual_benefits=v.pay.annual_benefits,e.pay.annual_deductions=v.pay.annual_deductions,angular.extend(e.revisionCreated,{details_revision_id:e.details.jobcontract_revision_id,health_revision_id:e.health.jobcontract_revision_id,hour_revision_id:e.hour.jobcontract_revision_id,jobcontract_id:m.contract.id,leave_revision_id:e.leave[0].jobcontract_revision_id,pay_revision_id:e.pay.jobcontract_revision_id,pension_revision_id:e.pension.jobcontract_revision_id}),_.length?(e.files=r.all(_),r.all(e)):e}).then(function(e){L=0;for(L;L<C;L++){w=N[L].name;if(y[w])for(x in y[w])S=y[w][x],S.queue.length&&D.push(d.upload(S,P))}return D.length?(O=t.open({targetDomEl:i.find("div").eq(0),templateUrl:E.pathApp+"views/modalProgress.html",size:"sm",controller:"ModalProgressCtrl",resolve:{uploader:function(){return y},promiseFilesUpload:function(){return D}}}),e.files=O.result,r.all(e)):e}).then(function(t){e.$broadcast("hrjc-loader-hide"),n.close(t)})):(e.$broadcast("hrjc-loader-hide"),n.close())}e.save=function(){if(angular.equals(m,e.entity)&&angular.equals(y,e.files)&&!e.uploader.details.contract_file.queue.length&&!e.uploader.pension.evidence_file.queue.length){e.$broadcast("hrjc-loader-hide"),n.dismiss("cancel");return}switch(v){case"edit":e.entity.contract.is_primary==m.contract.is_primary?N().then(function(e){switch(e){case"edit":C();break;case"change":T().then(function(e){k(e.reasonId,e.date)})}}):C();break;case"change":T().then(function(e){k(e.reasonId,e.date)});break;default:e.$broadcast("hrjc-loader-hide"),n.dismiss("cancel");return}}}}])}),define("controllers/modal/modalContractNew",["controllers/controllers","services/contract","services/contractDetails","services/contractHour","services/contractPay","services/contractLeave","services/contractHealth","services/contractPension","services/contractFiles","services/utils"],function(e){e.controller("ModalContractNewCtrl",["$scope","$modalInstance","$q","$modal","$rootElement","Contract","ContractService","ContractDetailsService","ContractHourService","ContractPayService","ContractLeaveService","ContractHealthService","ContractPensionService","ContractFilesService","model","UtilsService","utils","settings","$log",function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){y.debug("Controller: ModalContractNewCtrl"),e.allowSave=!0,e.copy={close:"Cancel",save:"Add New Job Contract",title:"Add New Job Contract"},e.entity={},e.isDisabled=!1,e.showIsPrimary=m.contractListLen,e.uploader={details:{contract_file:p.uploader("civicrm_hrjobcontract_details")},pension:{evidence_file:p.uploader("civicrm_hrjobcontract_pension",1)}},e.utils=m,angular.copy(d,e.entity),e.entity.contract={is_primary:0},e.cancel=function(){t.dismiss("cancel")},e.save=function(){e.$broadcast("hrjc-loader-show");var d=new s;d.$save({action:"create",json:{sequential:1,contact_id:g.contactId,is_primary:m.contractListLen?e.entity.contract.is_primary:1}},function(s){var d=s.values[0],m=d.id,y=e.entity.details,b=e.entity.hour,w=e.entity.pay,E=e.entity.leave,S=e.entity.health,x=e.entity.pension,T,N,C=[],k=e.uploader,L;d.is_current=!y.period_end_date||new Date(y.period_end_date)>new Date,v.prepareEntityIds(y,m),u.save(y).then(function(e){L=e.jobcontract_revision_id},function(e){return CRM.alert(e,"Error","error"),o.delete(m),t.dismiss(),n.reject()}).then(function(){return angular.forEach(e.entity,function(e){v.prepareEntityIds(e,m,L)}),N=[a.save(b),f.save(w),l.save(E),c.save(S),h.save(x)],e.uploader.details.contract_file.queue.length&&C.push(p.upload(k.details.contract_file,L)),e.uploader.pension.evidence_file.queue.length&&C.push(p.upload(k.pension.evidence_file,L)),C.length&&(T=r.open({targetDomEl:i.find("div").eq(0),templateUrl:g.pathApp+"views/modalProgress.html",size:"sm",controller:"ModalProgressCtrl",resolve:{uploader:function(){return k},promiseFilesUpload:function(){return C}}}),N.push(T.result)),n.all(N)},function(e){return CRM.alert(e,"Error","error"),t.dismiss(),n.reject()}).then(function(){e.$broadcast("hrjc-loader-hide"),t.close(d)})},function(r){return e.$broadcast("hrjc-loader-hide"),t.dismiss(),CRM.alert(r.statusText||"Unknown error","Error","error"),n.reject()})}}])}),define("controllers/modal/modalDialog",["controllers/controllers"],function(e){e.controller("ModalDialogCtrl",["$scope","$modalInstance","$timeout","content","$log",function(e,t,n,r,i){i.debug("Controller: ModalDialogCtrl"),e.title=r.title||"CiviHR Job Contract",e.msg=r.msg||"",e.copyConfirm=r.copyConfirm||"Yes",e.copyCancel=r.copyCancel||"Cancel",e.confirm=function(e){t.close(e||!0)},e.cancel=function(){t.dismiss("Cancel")}}])}),define("controllers/modal/modalProgress",["controllers/controllers"],function(e){e.controller("ModalProgressCtrl",["$scope","$modalInstance","$q","$timeout","uploader","promiseFilesUpload","$log",function(e,t,n,r,i,s,o){o.debug("Controller: ModalProgressCtrl");var u,a;e.uploader=i;for(u in i)for(a in i[u])i[u][a].queue.length&&(i[u][a].item=i[u][a].queue[0].file.name),i[u][a].onProgressItem=function(e){this.item=e.file.name};n.all(s).then(function(e){r(function(){t.close(e)},500)}),e.cancel=function(){t.dismiss("File upload canceled")}}])}),define("controllers/modal/modalRevision",["controllers/controllers"],function(e){e.controller("ModalRevisionCtrl",["$scope","$rootScope","$modalInstance","$filter","$q","settings","revisionDataList","revisionList","entity","fields","model","modalContract","utils","ContactService","$log",function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){function v(){var t=s.pathReport+(s.pathReport.indexOf("?")>-1?"&":"?"),n=e.entity,r,i;return angular.forEach(e.fields,function(e){r=e.name!="editor_name"?e.name:"editor_uid",i=e.extends?"":n+"_",e.selected&&(t+="fields["+i+r+"]=1&")}),t+="fields[sort_name]=1&fields[first_name]=1&fields[last_name]=1&fields[external_identifier]=1&fields[email]=1&fields[street_address]=1&fields[city]=1&fields[name]=1&fields[contract_contact_id]=1&fields[contract_contract_id]=1&fields[jobcontract_revision_id]=1&fields[change_reason]=1&fields[created_date]=1&fields[effective_date]=1&fields[modified_date]=1&order_bys[1][column]=id&order_bys[1][order]=ASC&order_bys[2][column]=civicrm_hrjobcontract_revision_revision_id&order_bys[2][order]=ASC&order_bys[3][column]=-&order_bys[3][order]=ASC&order_bys[4][column]=-&order_bys[4][order]=ASC&order_bys[5][column]=-&order_bys[5][order]=ASC&contract_id_op=eq&permission=access+CiviReport&row_count=&_qf_Summary_submit_csv=Preview+CSV&groups=&contract_id_value="+u[0].jobcontract_id+"&group_bys[civicrm_hrjobcontract_revision_revision_id]=1",t}d.debug("Controller: ModalRevisionCtrl"),e.$broadcast("hrjc-loader-show"),e.currentPage=1,e.entity=a,e.fields=angular.copy(f),e.itemsPerPage=5,e.revisionDataList=[],e.revisionList=[],e.sortCol="effective_date",e.subFields={},e.maxSize=5,e.modalContract=c,e.sortReverse=!0,function(){var t=0,n=e.fields.length,r;for(t;t<n;t++){r=e.fields[t],r.selected=!0,r.isArray=r.name=="leave_type"||r.name=="leave_amount";if(r.name=="id"||r.name=="jobcontract_revision_id"){r.display=!1;continue}r.display=!0}e.fields.unshift({name:"effective_date",title:"Effective Date",display:!0,selected:!0,isArray:!1,"extends":!0}),e.fields.push({name:"editor_name",title:"Change Recorded By",display:!0,selected:!0,isArray:!1,"extends":!0},{name:"change_reason",title:"Reason For Change",display:!0,selected:!0,isArray:!1,"extends":!0})}(),function(){var n=0,i,s,a=o.length,f;for(n;n<a;n++)i=n+1,s=i==a,o[n]||(o[n]=l),!s&&!o[i]&&(o[i]=l),angular.isArray(o[n])?(f=s||o[n][0].jobcontract_revision_id!=o[i][0].jobcontract_revision_id,o[n]={jobcontract_revision_id:o[n][0].jobcontract_revision_id,data:o[n]}):f=s||o[n].jobcontract_revision_id!=o[i].jobcontract_revision_id,f&&(angular.extend(o[n],{effective_date:r("date")(u[n].effective_date,"yyyy/MM/dd")||"",editor_name:u[n].editor_name||"",change_reason:t.options.contract.change_reason[u[n].change_reason]||""}),e.revisionDataList.push(o[n]))}();switch(a){case"hour":(function(){var t;angular.forEach(e.revisionDataList,function(e){e.location_standard_hours&&(t=r("filter")(h.hoursLocation,{id:e.location_standard_hours})[0],e.location_standard_hours=t.location+": "+t.standard_hours+"h per "+t.periodicity)})})();break;case"health":angular.forEach(e.revisionDataList,function(e){e.provider&&p.getOne(e.provider).then(function(t){e.provider=t.label}),e.provider_life_insurance&&p.getOne(e.provider_life_insurance).then(function(t){e.provider_life_insurance=t.label})});break;case"pay":(function(){var n;angular.forEach(e.revisionDataList,function(e){e.pay_scale&&(n=r("filter")(h.payScaleGrade,{id:e.pay_scale})[0]||r("filter")(h.payScaleGrade,{pay_scale:e.pay_scale})[0],e.pay_scale=n.pay_scale+(n.pay_grade?" - "+n.pay_grade:"")+(n.currency?" - "+t.options.pay.pay_currency[n.currency]:"")+(n.amount?" "+n.amount:"")+(n.periodicity?" per "+n.periodicity:""))})})(),r("filter")(e.fields,{name:"pay_is_auto_est"})[0].pseudoconstant=!0,e.subFields={annual_benefits:[{name:"name",title:"Benefit",pseudoconstant:"benefit_name"},{name:"type",title:"Type",pseudoconstant:"benefit_type"},{name:"amount_pct",title:"% amount",pseudoconstant:!1},{name:"amount_abs",title:"Absolute amount",pseudoconstant:!1}],annual_deductions:[{name:"name",title:"Deduction",pseudoconstant:"deduction_name"},{name:"type",title:"Type",pseudoconstant:"deduction_type"},{name:"amount_pct",title:"% amount",pseudoconstant:!1},{name:"amount_abs",title:"Absolute amount",pseudoconstant:!1}]};break;case"pension":r("filter")(e.fields,{name:"is_enrolled"})[0].pseudoconstant=!0}e.urlCSV=v(),e.createPage=function(){var t=(e.currentPage-1)*e.itemsPerPage,n=t+e.itemsPerPage;e.revisionDataListPage=e.revisionDataList.slice(t,n)},e.sortBy=function(t,n){typeof t!="undefined"&&(e.sortCol==t?e.sortReverse=!e.sortReverse:e.sortCol=t),typeof n!="undefined"&&(e.sortReverse=n),e.revisionDataList=r("orderBy")(e.revisionDataList,e.sortCol,e.sortReverse)},e.sortBy(),e.toggleFieldsSelected=function(t){t.selected=!t.selected,e.urlCSV=v()},n.opened.then(function(){t.$broadcast("hrjc-loader-hide")}),e.cancel=function(){n.dismiss("cancel")},e.$watch("currentPage",function(){e.createPage()})}])}),define("controllers/form/formGeneral",["controllers/controllers","moment"],function(e,t){e.controller("FormGeneralCtrl",["$scope","$log","$timeout",function(e,n){function i(e,n){if(!e||!n)return"Unspecified";var r,i,s,o;return s=t(n),o=s.diff(e,"years"),s.add(-o,"years"),i=s.diff(e,"months"),s.add(-i,"months"),r=s.diff(e,"days"),o=o>0?o>1?o+" years ":o+" year ":"",i=i>0?i>1?i+" months ":i+" month ":"",r=r>0?r>1?r+" days":r+" day":"",o+i+r||"0 days"}n.debug("Controller: FormGeneralCtrl");var r=e.entity.details;e.dpOpen=function(t,n){t.preventDefault(),t.stopPropagation(),e[n]=!0},e.$watch("entity.details.period_start_date",function(){t(r.period_start_date),e.dpDateEndMin=t(r.period_start_date).add(1,"day").format(),e.duration=i(r.period_start_date,r.period_end_date)}),e.$watch("entity.details.period_end_date",function(){e.dpDateStartMax=r.period_end_date?t(r.period_end_date).subtract(1,"day").format():r.period_end_date="",e.duration=i(r.period_start_date,r.period_end_date)}),e.$watch("entity.details.position",function(t,n){t!=n&&r.title==n&&(e.contractForm.detailsTitle.$setViewValue(t),e.contractForm.detailsTitle.$render())}),e.$watch("entity.details.notice_amount",function(t){+t&&!r.notice_unit&&(e.contractForm.detailsNoticeUnit.$setValidity("required",!1),e.contractForm.detailsNoticeUnit.$dirty=!0)}),e.$watch("entity.details.notice_amount_employee",function(t){+t&&!r.notice_unit_employee&&(e.contractForm.detailsNoticeUnitEmployee.$setValidity("required",!1),e.contractForm.detailsNoticeUnitEmployee.$dirty=!0)})}])}),define("fraction",[],function(){var e=function(t,n){if(typeof t!="undefined"&&n)typeof t=="number"&&typeof n=="number"?(this.numerator=t,this.denominator=n):typeof t=="string"&&typeof n=="string"&&(this.numerator=parseInt(t),this.denominator=parseInt(n));else if(typeof n=="undefined"){num=t;if(typeof num=="number")this.numerator=num,this.denominator=1;else if(typeof num=="string"){var r,i,s=num.split(" ");s[0]&&(r=s[0]),s[1]&&(i=s[1]);if(r%1===0&&i&&i.match("/"))return(new e(r)).add(new e(i));if(!r||!!i)return undefined;if(typeof r=="string"&&r.match("/")){var o=r.split("/");this.numerator=o[0],this.denominator=o[1]}else{if(typeof r=="string"&&r.match("."))return new e(parseFloat(r));this.numerator=parseInt(r),this.denominator=1}}}this.normalize()};return e.prototype.clone=function(){return new e(this.numerator,this.denominator)},e.prototype.toString=function(){if(this.denominator==="NaN")return"NaN";var e=this.numerator/this.denominator>0?Math.floor(this.numerator/this.denominator):Math.ceil(this.numerator/this.denominator),t=this.numerator%this.denominator,n=this.denominator,r=[];return e!=0&&r.push(e),t!=0&&r.push((e===0?t:Math.abs(t))+"/"+n),r.length>0?r.join(" "):0},e.prototype.rescale=function(e){return this.numerator*=e,this.denominator*=e,this},e.prototype.add=function(t){var n=this.clone();return t instanceof e?t=t.clone():t=new e(t),td=n.denominator,n.rescale(t.denominator),t.rescale(td),n.numerator+=t.numerator,n.normalize()},e.prototype.subtract=function(t){var n=this.clone();return t instanceof e?t=t.clone():t=new e(t),td=n.denominator,n.rescale(t.denominator),t.rescale(td),n.numerator-=t.numerator,n.normalize()},e.prototype.multiply=function(t){var n=this.clone();if(t instanceof e)n.numerator*=t.numerator,n.denominator*=t.denominator;else{if(typeof t!="number")return n.multiply(new e(t));n.numerator*=t}return n.normalize()},e.prototype.divide=function(t){var n=this.clone();if(t instanceof e)n.numerator*=t.denominator,n.denominator*=t.numerator;else{if(typeof t!="number")return n.divide(new e(t));n.denominator*=t}return n.normalize()},e.prototype.equals=function(t){t instanceof e||(t=new e(t));var n=this.clone().normalize(),t=t.clone().normalize();return n.numerator===t.numerator&&n.denominator===t.denominator},e.prototype.normalize=function(){var t=function(e){return typeof e=="number"&&(e>0&&e%1>0&&e%1<1||e<0&&e%-1<0&&e%-1>-1)},n=function(e,t){if(!t)return Math.round(e);var n=Math.pow(10,t);return Math.round(e*n)/n};return function(){if(t(this.denominator)){var r=n(this.denominator,9),i=Math.pow(10,r.toString().split(".")[1].length);this.denominator=Math.round(this.denominator*i),this.numerator*=i}if(t(this.numerator)){var r=n(this.numerator,9),i=Math.pow(10,r.toString().split(".")[1].length);this.numerator=Math.round(this.numerator*i),this.denominator*=i}var s=e.gcf(this.numerator,this.denominator);this.numerator/=s,this.denominator/=s;if(this.numerator<0&&this.denominator<0||this.numerator>0&&this.denominator<0)this.numerator*=-1,this.denominator*=-1;return this}}(),e.gcf=function(t,n){var r=[],i=e.primeFactors(t),s=e.primeFactors(n);i.forEach(function(e){var t=s.indexOf(e);t>=0&&(r.push(e),s.splice(t,1))});if(r.length===0)return 1;var o=function(){var e=r[0],t;for(t=1;t<r.length;t++)e*=r[t];return e}();return o},e.primeFactors=function(e){var t=Math.abs(e),n=[],r=2;while(r*r<=t)t%r===0?(n.push(r),t/=r):r++;return t!=1&&n.push(t),n},e}),define("controllers/form/formHour",["fraction","controllers/controllers"],function(e,t){t.controller("FormHourCtrl",["$scope","$rootScope","$filter","$log",function(t,n,r,i){function a(e,n){t.hrsTypeDefined=typeof s.hours_type!="undefined"&&s.hours_type!=null&&s.hours_type!="";if(t.hrsTypeDefined){s.hours_unit=e.periodicity;switch(+n){case 8:s.hours_amount=e.standard_hours;break;case 4:s.hours_amount=s.hours_amount?s.hours_amount:Math.round(e.standard_hours/2);break;case 0:s.hours_amount=s.hours_amount?s.hours_amount:0;break;default:s.hours_amount=""}return}s.hours_unit="",s.hours_amount=""}function f(n,r){r=parseFloat(r)||0,n=parseFloat(n)||0;var i=new e(r,n);s.fte_num=String(+s.hours_type?i.numerator:0),s.fte_denom=String(+s.hours_type?i.denominator:0),s.hours_fte=String(parseFloat((s.fte_num/s.fte_denom||0).toFixed(2))),t.fteFraction=s.fte_num+"/"+s.fte_denom}i.debug("Controller: FormHourCtrl");var s=t.entity.hour,o=t.utils.hoursLocation,u={};t.hrsTypeDefined=!1,s.location_standard_hours=s.location_standard_hours||"1",u=r("getObjById")(o,s.location_standard_hours),t.$watch("entity.hour.location_standard_hours",function(e){u=r("getObjById")(o,e),a(u,s.hours_type),f(u.standard_hours,s.hours_amount)}),t.$watch("entity.hour.hours_type",function(e,t){e!=t&&(a(u,e),f(u.standard_hours,s.hours_amount))}),t.$watch("entity.hour.hours_amount",function(e,t){e!=t&&f(u.standard_hours,e)}),t.$watch("entity.hour.hours_unit",function(e,t){e!=t&&f(u.standard_hours,s.hours_amount)})}])}),define("controllers/form/formHealth",["controllers/controllers","services/contact"],function(e){e.controller("FormHealthCtrl",["$scope","ContactService","$log",function(e,t,n){n.debug("Controller: FormHealthCtrl"),e.typehead={provider:"",provider_life_insurance:""};var r;angular.forEach(e.typehead,function(n,i){r=e.entity.health[i],r&&t.getOne(r).then(function(t){e.typehead[i]=t}),e.$watch("typehead."+i,function(t){e.entity.health[i]=t?t.id:t})}),e.search=function(e,n){return t.search(e,{contact_type:"Organization",contact_sub_type:n}).then(function(e){return e})}}])}),define("controllers/form/formPay",["controllers/controllers"],function(e){e.controller("FormPayCtrl",["$scope","$filter","settings","$log",function(e,t,n,r){function a(){var e=1;switch(+i.pay_cycle){case 1:e=u.Week;break;case 2:e=u.Month}return e}r.debug("Controller: FormPayCtrl");var i=e.entity.pay||{},s={pay_amount:0,pay_currency:n.CRM.defaultCurrency,pay_cycle:"2",pay_unit:"Year"},o=e.utils.payScaleGrade,u={Year:1,Month:12,Week:52,Fortnight:26,Day:260,Hour:2080};e.collapseBenDed=!i.annual_benefits.length&&!i.annual_deductions.length,e.benefits_per_cycle=0..toFixed(2),e.benefits_per_cycle_net=0,e.deductions_per_cycle=0..toFixed(2),i.is_paid=i.is_paid||0,i.pay_is_auto_est="0",i.annual_benefits=i.annual_benefits||[],i.annual_deductions=i.annual_deductions||[],e.add=function(e){e.push({name:"",type:"",amount_pct:"",amount_abs:""})},e.applyPayScaleGradeData=function(){if(i.pay_scale){var e=t("getObjById")(o,i.pay_scale);i.pay_amount=e.amount||s.pay_amount,i.pay_currency=e.currency||s.pay_currency,i.pay_unit=e.periodicity||s.pay_unit}},e.calcAnnualPayEst=function(){+i.is_paid&&(i.pay_annualized_est=(i.pay_amount*u[i.pay_unit]||0).toFixed(2))},e.calcBenefitsPerCycle=function(){if(+i.is_paid){var t=0,n=i.annual_benefits.length,r=0;for(t;t<n;t++)+i.annual_benefits[t].type==2&&(i.annual_benefits[t].amount_abs=(i.annual_benefits[t].amount_pct/100*i.pay_annualized_est).toFixed(2)),r+=+i.annual_benefits[t].amount_abs;e.benefits_per_cycle=(r/a()).toFixed(2)}},e.calcBenefitsPerCycleNet=function(){+i.is_paid&&(e.benefits_per_cycle_net=e.benefits_per_cycle-e.deductions_per_cycle)},e.calcDeductionsPerCycle=function(){if(+i.is_paid){var t=0,n=i.annual_deductions.length,r=0;for(t;t<n;t++)+i.annual_deductions[t].type==2&&(i.annual_deductions[t].amount_abs=(i.annual_deductions[t].amount_pct/100*i.pay_annualized_est).toFixed(2)),r+=+i.annual_deductions[t].amount_abs;e.deductions_per_cycle=(r/a()).toFixed(2)}},e.calcPayPerCycleGross=function(){+i.is_paid&&(i.pay_per_cycle_gross=(i.pay_annualized_est/a()).toFixed(2))},e.calcPayPerCycleNet=function(){+i.is_paid&&(i.pay_per_cycle_net=(+i.pay_per_cycle_gross+ +e.benefits_per_cycle_net).toFixed(2))},e.resetData=function(){i.pay_scale="",i.pay_amount="",i.pay_unit="",i.pay_currency="",i.pay_annualized_est="",i.pay_is_auto_est="",i.annual_benefits=[],i.annual_deductions=[],i.pay_cycle="",i.pay_per_cycle_gross="",i.pay_per_cycle_net="",e.benefits_per_cycle="",e.deductions_per_cycle=""},e.setDefaults=function(){i.pay_cycle=s.pay_cycle,i.pay_currency=s.pay_currency,i.pay_is_auto_est="0",i.pay_amount=0..toFixed(2)},e.remove=function(e,t){e.splice(t,1)},e.$watch("entity.pay.pay_amount",e.calcAnnualPayEst),e.$watch("entity.pay.pay_unit",e.calcAnnualPayEst),e.$watch("entity.pay.pay_annualized_est",function(){e.calcPayPerCycleGross(),e.calcBenefitsPerCycle(),e.calcDeductionsPerCycle()}),e.$watch("entity.pay.annual_benefits",e.calcBenefitsPerCycle,!0),e.$watch("entity.pay.annual_deductions",e.calcDeductionsPerCycle,!0),e.$watch("benefits_per_cycle",e.calcBenefitsPerCycleNet),e.$watch("deductions_per_cycle",e.calcBenefitsPerCycleNet),e.$watch("benefits_per_cycle_net",e.calcPayPerCycleNet),e.$watch("entity.pay.pay_per_cycle_gross",e.calcPayPerCycleNet)}])}),define("controllers/form/formPension",["controllers/controllers","services/contact"],function(e){e.controller("FormPensionCtrl",["$scope","settings","$log",function(e,t,n){n.debug("Controller: FormPensionCtrl")}])}),define("directives/contact",["directives/directives"],function(e){e.directive("hrjcContact",["$compile","ContactService","settings","$log",function(e,t,n,r){return r.debug("Directive: hrjcContact"),{restrict:"A",scope:{renderAsLink:"=?hrjcContactLink",contactId:"=?hrjcContact"},template:"{{contact.label}}",link:function(n,r){if(!n.contactId)return;n.$watch("contactId",function(i){t.getOne(n.contactId).then(function(t){n.contact=t,n.renderAsLink&&(r.html('<a ng-href="/civicrm/contact/view?reset=1&cid={{contactId}}">{{contact.label}}</a>'),e(r.contents())(n))})})}}}])}),define("directives/loader",["directives/directives"],function(e){e.directive("hrjcLoader",["$rootScope","$log",function(e,t){return t.debug("Directive: hrjcLoader"),{link:function(e,t,n){function s(){var e=window.getComputedStyle(t[0]).position;return e=="relative"||e=="absolute"||e=="fixed"}function o(){s()||(t.css("position","relative"),i=!0),t.append(r)}function u(){r.remove(),i&&t.css("position","")}var r=document.createElement("div"),i=!1;r.className="hrjc-loader",n.hrjcLoaderShow&&o(),e.$on("hrjc-loader-show",function(){o()}),e.$on("hrjc-loader-hide",function(){u()})}}}])}),define("directives/number",["directives/directives"],function(e){e.directive("hrjcNumber",["$log",function(e){return e.debug("Directive: hrjcNumber"),{require:"ngModel",link:function(e,t,n,r){var i=2,s=n.hrjcNumberFloat||!1;n.hrjcNumber&&typeof +n.hrjcNumber=="number"&&(i=n.hrjcNumber),t.bind("blur",function(){var e=parseFloat(r.$viewValue)||0;r.$setViewValue(s?Math.round(e*100)/100:e.toFixed(i)),r.$render()})}}}])}),define("directives/validate",["directives/directives"],function(e){e.directive("hrjcValidate",["$log",function(e){return e.debug("Directive: hrjcValidate"),{restrict:"A",require:"^form",scope:{isWarning:"=?hrjcValidateWarning"},link:function(e,t,n,r){function f(e,n){t.toggleClass("has-success",!e&&!n),a.toggleClass("glyphicon-ok",!e&&!n)}function l(e,n){t.toggleClass("has-warning",!e&&n),a.toggleClass("glyphicon-warning-sign",!e&&n)}function c(e){t.toggleClass("has-error",e),a.toggleClass("glyphicon-remove",e)}var i=t[0].querySelector("[name]"),s=angular.element(i),o=s.attr("name"),u=document.createElement("span"),a=angular.element(u);if(!o)return;t.addClass("has-feedback"),a.addClass("glyphicon form-control-feedback"),s.after(a),e.$watch(function(){return r[o]&&r[o].$invalid},function(t){r[o].$dirty&&(f(t,e.isWarning),c(t))}),typeof e.isWarning!="undefined"&&e.$watch("isWarning",function(e){var t=r[o].$invalid;r[o].$dirty&&(f(t,e),l(t,e))}),s.bind("blur",function(){c(r[o].$invalid)})}}}])}),define("filters/capitalize",["filters/filters"],function(e){e.filter("capitalize",["$log",function(e){return e.debug("Filter: capitalize"),function(e){return e?e.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}}])}),define("filters/formatAmount",["filters/filters"],function(e){e.filter("formatAmount",["$log",function(e){return e.debug("Filter: formatAmount"),function(e){return e&&e.indexOf(".")===-1?e+".00":e}}])}),define("filters/formatPeriod",["filters/filters"],function(e){e.filter("formatPeriod",["$filter","$log",function(e,t){return t.debug("Filter: formatPeriod"),function(t){return t?e("date")(t,"yyyy/MM/dd"):"Unspecified"}}])}),define("filters/parseInt",["filters/filters"],function(e){e.filter("parseInt",["$log",function(e){return e.debug("Filter: parseInt"),function(e){return e?parseInt(e):null}}])});var e,t=require.config({context:"hrjobcontract",baseUrl:CRM.jobContractTabApp.path+"js",urlArgs:"bust="+(new Date).getTime(),paths:{angular:CRM.vars.reqAngular.angular,angularAnimate:CRM.vars.reqAngular.angularAnimate,angularBootstrap:CRM.vars.reqAngular.angularBootstrap,angularFileUpload:CRM.vars.reqAngular.angularFileUpload,angularResource:CRM.vars.reqAngular.angularResource,angularRoute:CRM.vars.reqAngular.angularRoute,fraction:"vendor/fraction",moment:"vendor/moment.min",requireLib:CRM.vars.reqAngular.requireLib},shim:{angular:{exports:"angular"},angularAnimate:{deps:["angular"]},angularBootstrap:{deps:["angular"]},angularResource:{deps:["angular"]},angularRoute:{deps:["angular"]}}});t(["angular","app","services/contract","controllers/contractList","controllers/contract","controllers/revisionList","controllers/modal/modalChangeReason","controllers/modal/modalContract","controllers/modal/modalContractNew","controllers/modal/modalDialog","controllers/modal/modalProgress","controllers/modal/modalRevision","controllers/form/formGeneral","controllers/form/formHour","controllers/form/formHealth","controllers/form/formPay","controllers/form/formPension","directives/contact","directives/directives","directives/loader","directives/number","directives/validate","filters/capitalize","filters/getObjById","filters/formatAmount","filters/formatPeriod","filters/parseInt","requireLib"],function(e,t){t.constant("settings",{classNamePrefix:"hrjc-",contactId:CRM.jobContractTabApp.contactId,debug:+CRM.debug,pathApp:CRM.jobContractTabApp.path,pathFile:CRM.url("civicrm/hrjobcontract/file/"),pathReport:CRM.url("civicrm/report/hrjobcontract/summary"),pathRest:CRM.url("civicrm/ajax/rest"),pathTpl:CRM.jobContractTabApp.path+"views/",CRM:{options:CRM.FieldOptions||{},defaultCurrency:CRM.jobContractTabApp.defaultCurrency,apiTsFmt:"YYYY-MM-DD HH:mm:ss",fields:CRM.jobContractTabApp.fields}}),t.config(["settings","$routeProvider","$resourceProvider","$logProvider","$httpProvider",function(e,t,n,r,i){r.debugEnabled(e.debug),t.when("/",{controller:"ContractListCtrl",templateUrl:e.pathApp+"views/contractList.html?v="+(new Date).getTime(),resolve:{contractList:["ContractService",function(e){return e.get()}]}}).otherwise({redirectTo:"/"}),n.defaults.stripTrailingSlashes=!1,i.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]),t.run(["settings","$rootScope","$q","$log","ContractService","ContractDetailsService","ContractHourService","ContractPayService","ContractLeaveService","ContractHealthService","ContractPensionService",function(e,t,n,r,i,s,o,u,a,f,l){r.debug("app.run"),t.pathTpl=e.pathTpl,t.prefix=e.classNamePrefix,n.all({contract:i.getRevisionOptions(),details:s.getOptions(),hour:o.getOptions(),pay:u.getOptions(),leave:a.getOptions(),health:f.getOptions(),pension:l.getOptions()}).then(function(e){e.pay.pay_is_auto_est=["No","Yes"],e.pension.is_enrolled=["No","Yes","Opted out"],r.debug("OPTIONS:"),r.debug(e),t.options=e})}]),document.addEventListener("hrjcLoad",function(){e.bootstrap(document.getElementById("hrjob-contract"),["hrjc"])})}),define("hrjc-main",function(){})})();