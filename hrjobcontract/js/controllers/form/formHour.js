define(['fraction','controllers/controllers'], function(Fraction, controllers){    controllers.controller('FormHourCtrl',['$scope', '$rootScope', '$filter', '$log',        function($scope, $rootScope, $filter, $log){            $log.debug('Controller: FormHourCtrl');            var contractHour = $scope.contract.hour,                utilsHoursLocation = $scope.utils.hoursLocation,                locStandHrs = {};            $scope.hrsTypeDefined = false;            contractHour.location_standard_hours = contractHour.location_standard_hours || "1";            locStandHrs = $filter('getObjById')(utilsHoursLocation, contractHour.location_standard_hours);            function updateHours(locStandHrs, hrsTypeId) {                $scope.hrsTypeDefined = typeof contractHour.hours_type !== 'undefined' &&  contractHour.hours_type != null && contractHour.hours_type != '';                if ($scope.hrsTypeDefined) {                    contractHour.hours_unit = locStandHrs.periodicity;                    switch(+hrsTypeId) {                        case 8:                            contractHour.hours_amount = locStandHrs.standard_hours;                            break;                        case 4:                            contractHour.hours_amount = !!contractHour.hours_amount ? contractHour.hours_amount : Math.round(locStandHrs.standard_hours / 2);                            break;                        case 0:                            contractHour.hours_amount = !!contractHour.hours_amount ? contractHour.hours_amount : 0;                            break;                        default:                            contractHour.hours_amount = '';                    }                    return                }                contractHour.hours_unit = '';                contractHour.hours_amount = '';            }            function updateFTE(hrsStandard, hrsAmount){                hrsAmount = parseFloat(hrsAmount) || 0,                hrsStandard = parseFloat(hrsStandard) || 0;                var fteFraction = new Fraction(hrsAmount, hrsStandard);                contractHour.fte_num = String(+contractHour.hours_type ? fteFraction.numerator : 0);                contractHour.fte_denom = String(+contractHour.hours_type ? fteFraction.denominator : 0);                contractHour.hours_fte = String(parseFloat(((contractHour.fte_num/contractHour.fte_denom) || 0).toFixed(2)));                $scope.fteFraction = contractHour.fte_num + '/' + contractHour.fte_denom;            }            $scope.$watch('contract.hour.location_standard_hours', function(locStandHrsId){                locStandHrs = $filter('getObjById')(utilsHoursLocation, locStandHrsId);                updateHours(locStandHrs, contractHour.hours_type);                updateFTE(locStandHrs.standard_hours, contractHour.hours_amount);            });            $scope.$watch('contract.hour.hours_type', function(hrsTypeId, hrsTypeIdPrev){                if (hrsTypeId != hrsTypeIdPrev) {                    updateHours(locStandHrs, hrsTypeId);                    updateFTE(locStandHrs.standard_hours, contractHour.hours_amount);                }            });            $scope.$watch('contract.hour.hours_amount', function(hrsAmount, hrsAmountPrev){                if (hrsAmount != hrsAmountPrev) {                    updateFTE(locStandHrs.standard_hours, hrsAmount);                }            });            $scope.$watch('contract.hour.hours_unit', function(hrsUnit, hrsUnitPrev){                if (hrsUnit != hrsUnitPrev) {                    updateFTE(locStandHrs.standard_hours, contractHour.hours_amount);                }            });        }]);});