(function(){define("controllers/controllers",[],function(){"use strict";return angular.module("hrjobroles.controllers",[])}),define("directives/directives",[],function(){"use strict";return angular.module("hrjobroles.directives",[])}),define("filters/filters",[],function(){"use strict";return angular.module("hrjobroles.filters",[])}),define("services/services",[],function(){"use strict";return angular.module("hrjobroles.services",[])}),define("app",["controllers/controllers","directives/directives","filters/filters","services/services"],function(){return angular.module("hrjobroles",["ngAnimate","ngRoute","ngResource","ui.bootstrap","hrjobroles.controllers","hrjobroles.directives","hrjobroles.filters","hrjobroles.services"])}),define("controllers/example",["controllers/controllers"],function(e){e.controller("ExampleCtrl",["$scope","$log","$routeParams","ExampleService","$route","$timeout",function(e,t,n,r,i,s){function u(t){r.getContracts(t).then(function(e){console.log(e)},function(t){e.error=t})}function a(t){r.getContracts(t).then(function(t){console.log(t);var n=[],i=[];if(t.count!=0){for(var s=0;s<t.count;s++)console.log(t.values[s].id),n.push(t.values[s].id),i.push({id:t.values[s].id,title:t.values[s].title});o.contractsData=i,console.log(o),r.getAllJobRoles(n).then(function(e){o.getData=e.values,e.is_error==1?o.status="Data load failure":(e.count==0&&(o.empty="No Job Roles found!"),console.log(o),o.status="Data load OK")},function(t){e.error=t})}else console.log("no job contract"),o.empty="No Job Contracts found for this Contact!"},function(t){e.error=t})}function f(t){r.deleteJobRole(t).then(function(e){e.is_error==1?(o.message_type="alert-danger",o.message="Role delete failure!"):(o.message_type="alert-success",o.message="Role deleted successfully!"),s(function(){o.message=null},3e3)},function(t){e.error=t})}t.debug("Controller: ExampleCtrl"),e.collapsedRows=[],e.view_tab=[],e.edit_data=[],e.backup_data=[],e.currentFilterId=1,e.add_new_role_url=e.$parent.pathBaseUrl+e.$parent.pathIncludeTpl+"add_new_role.html",e.contractsData=[],e.changeTab=function(t,n){e.view_tab[t]=n},e.isTab=function(t,n){return e.view_tab[t]==n?!0:!1},e.isThingsCollapsed=function(t){return e.collapsedRows[t]==1?!0:e.collapsedRows[t]==0?!1:!0},e.collapseRow=function(t){e.collapsedRows[t]==0?e.collapsedRows[t]=!0:e.collapsedRows[t]=!1},e.initData=function(t,n,r){e.edit_data[t]=[],e.edit_data[t][n]=r,e.backup_data[t]=[],e.backup_data[t][n]=r},e.resetData=function(t){setTimeout(function(){e.edit_data[t].title=e.backup_data[t].title,e.edit_data[t].is_edit=!1,e.$apply()},5)},e.isChanged=function(t){return e.edit_data[t]["is_edit"]==1?!0:!1},e.showSave=function(t){console.log(e.edit_data),e.edit_data[t].is_edit=!0},e.saveNewRole=function(e){console.log("save"),i.reload()},e.add_new_role=function(){e.add_new=!0},e.removeRole=function(t){console.log("delete"),f(t),a(e.$parent.contactId)},e.filterItems=[{id:1,name:"Active"},{id:2,name:"Inactive"}],e.filterChange=function(){e.currentFilterId=e.currentFilter.id,console.log(e.currentFilterId,e.currentFilter)};var o=this;a(e.$parent.contactId)}])}),define("services/example",["services/services"],function(e){e.factory("ExampleService",["settings","$log","$q",function(e,t,n){return t.debug("Service: ExampleService"),{getContracts:function(e){console.log(e);var t=n.defer();return CRM.api3("HRJobContract","get",{sequential:1,contact_id:e,deleted:0,"return":"id,title"}).done(function(e){console.log(e),t.resolve(e)}).error(function(e){t.reject("An error occured while fetching items")}),t.promise},getAllJobRoles:function(e){console.log(e);var t=n.defer();return CRM.api3("HrJobRoles","get",{sequential:1,"return":"id,job_contract_id,title",job_contract_id:{IN:e}}).done(function(e){console.log(e),t.resolve(e)}).error(function(e){t.reject("An error occured while fetching items")}),t.promise},deleteJobRole:function(e){console.log(e);var t=n.defer();return CRM.api3("HrJobRoles","delete",{sequential:1,id:e}).done(function(e){console.log(e),t.resolve(e)}).error(function(e){t.reject("An error occured while deleting items")}),t.promise}}}])}),define("directives/example",["directives/directives"],function(e){e.directive("example",["$rootScope","$log",function(e,t){return t.debug("Directive: example"),{link:function(e,t,n){}}}])});var e=require.config({context:"hrjobroles",baseUrl:CRM.vars.hrjobroles.baseURL+"/js",urlArgs:"bust="+(new Date).getTime(),paths:{requireLib:CRM.vars.reqAngular.requireLib}});e(["app","controllers/example","services/example","directives/example","requireLib"],function(e){e.constant("settings",{classNamePrefix:"hrjobroles-",contactId:decodeURIComponent(((new RegExp("[?|&]cid=([^&;]+?)(&|#|;|$)")).exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null,debug:!0,pathApp:"",pathRest:CRM.url("civicrm/ajax/rest"),pathBaseUrl:CRM.vars.hrjobroles.baseURL+"/",pathTpl:"views/",pathIncludeTpl:"views/include/"}),e.config(["settings","$routeProvider","$resourceProvider","$httpProvider","$logProvider",function(e,t,n,r,i){i.debugEnabled(e.debug),t.when("/",{controller:"ExampleCtrl",templateUrl:e.pathBaseUrl+e.pathTpl+"mainTemplate.html",resolve:{}}).otherwise({redirectTo:"/"}),n.defaults.stripTrailingSlashes=!1,r.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]),e.run(["settings","$rootScope","$q","$log",function(e,t,n,r){r.debug("app.run"),t.contactId=e.contactId,t.pathBaseUrl=e.pathBaseUrl,t.pathTpl=e.pathTpl,t.pathIncludeTpl=e.pathIncludeTpl,t.prefix=e.classNamePrefix}]),document.addEventListener("hrjobrolesLoad",function(){angular.bootstrap(document.getElementById("hrjobroles"),["hrjobroles"])})}),define("hrjobroles-main",function(){})})();