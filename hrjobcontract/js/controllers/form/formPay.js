console.log('Controller: FormPayCtrl');define(['controllers/controllers'], function(controllers){    controllers.controller('FormPayCtrl',['$scope','$filter','settings',        function($scope, $filter, settings){            var contractPay = $scope.contract.pay || {},                defaults = {                    pay_amount: 0,                    pay_currency: settings.CRM.defaultCurrency,                    pay_cycle: '2',                    pay_unit: 'Year'                },                utilsPayScaleGrade = $scope.utils.payScaleGrade,                workPerYear = (function(){                    var workDaysPerYear = !(new Date(new Date().getFullYear(), 1, 29).getMonth() == 1) ? 365 : 366,                        workHoursPerYear = workDaysPerYear * 8;                    return {                        Year: 1,                        Month: 12,                        Week: 52,                        Fortnight: 26,                        Day: workDaysPerYear,                        Hour: workHoursPerYear                    }                }());            $scope.collapseBenDed = !contractPay.annual_benefits.length && !contractPay.annual_deductions.length;            contractPay.is_paid = contractPay.is_paid || 0;            contractPay.pay_is_auto_est = '';            $scope.add = function(array){                array.push({                    "name": "",                    "type": "",                    "amount_pct": "",                    "amount_abs": ""                });            };            $scope.applyPayScaleGradeData = function(){                var payScaleGrade = $filter('getObjById')(utilsPayScaleGrade, contractPay.pay_scale);                console.log(payScaleGrade);                contractPay.pay_amount = payScaleGrade.amount || defaults.pay_amount;                contractPay.pay_currency = payScaleGrade.currency || defaults.pay_currency;                contractPay.pay_unit = payScaleGrade.periodicity || defaults.pay_unit;            };            $scope.resetData = function(){                contractPay.pay_scale = null;                contractPay.pay_amount = null;                contractPay.pay_unit = null;                contractPay.pay_currency = null;                contractPay.pay_annualized_est = null;                contractPay.pay_is_auto_est = null;                contractPay.annual_benefits = [];                contractPay.annual_deductions = [];                contractPay.pay_cycle = null;            };            $scope.setDefaults = function(){                contractPay.pay_cycle = defaults.pay_cycle;                contractPay.pay_currency = defaults.pay_currency;                contractPay.pay_is_auto_est = '';            };            $scope.remove = function(array, index){                array.splice(index, 1);            };            $scope.$watch('contract.pay.pay_amount', function(payAmnt){                //contractPay.pay_amount = $filter('currency')(payAmnt, '', 2);                contractPay.pay_annualized_est = contractPay.pay_amount * workPerYear[contractPay.pay_unit];            });            $scope.$watch('contract.pay.pay_unit', function(){                contractPay.pay_annualized_est = contractPay.pay_amount * workPerYear[contractPay.pay_unit];            });        }]);});